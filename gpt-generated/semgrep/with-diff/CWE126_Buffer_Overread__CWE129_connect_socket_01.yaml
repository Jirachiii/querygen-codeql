rules:
  - id: CWE126_Buffer_Overread__CWE129_connect_socket_01
    message: "Possible buffer over-read detected"
    severity: ERROR
    metadata:
      cwe: "CWE126"
    languages: [c]
    patterns:
      - pattern: |
          if ($INDEX >= 0) {
            ...
            $BUFFER[$INDEX];
            ...
          }
      - pattern-not: |
          if ($INDEX >= 0 && $INDEX < $UPPER_BOUND) {
            ...
            $BUFFER[$INDEX];
            ...
          }