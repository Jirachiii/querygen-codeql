rules:
  - id: CWE259_Hard_Coded_Password__w32_char_01
    message: "Detects use of hardcoded password (CWE-259)"
    severity: ERROR
    metadata:
      cwe: "CWE259"
    languages: [c]
    patterns:
      - pattern: |
          strcpy($PASSWORD_VAR, $HARDCODED_VALUE);
      - pattern-not: |
          fgets($PASSWORD_VAR, $BUFFER_SIZE, stdin);