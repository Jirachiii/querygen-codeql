rules:
  - id: CWE191_Integer_Underflow__char_fscanf_multiply_02
    message: "Potential integer underflow detected when multiplying a char."
    severity: ERROR
    metadata:
      cwe: "CWE191"
    languages: [c, cpp]
    patterns:
      - pattern: |
          if ($DATA < 0) {
              char $RESULT = $DATA * 2;
              ...
          }
      - pattern-not: |
          if ($DATA < 0) {
              if ($DATA > (CHAR_MIN / 2)) {
                  char $RESULT = $DATA * 2;
                  ...
              } else {
                  ...
              }
          }