rules:
  - id: CWE259_Hard_Coded_Password__w32_char_01
    message: "Detected use of hard-coded password"
    severity: ERROR
    metadata:
      cwe: "CWE259"
    languages: [c, cpp]
    patterns:
      - pattern: |
          char * password;
          ...
          /* FLAW: Use a hardcoded password */
          strcpy(password, $HARD_CODED_PASSWORD);
      - pattern-not: |
          char * password;
          ...
          /* FIX: Read the password from the console */
          if (fgets(password, 100, stdin) == NULL)
          ...