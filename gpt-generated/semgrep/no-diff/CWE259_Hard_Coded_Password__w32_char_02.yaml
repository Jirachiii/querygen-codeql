rules:
  - id: CWE259_Hard_Coded_Password__w32_char_02
    message: "Use of hardcoded password detected - CWE259"
    severity: ERROR
    metadata:
      cwe: "CWE259"
    languages: [c, cpp]
    patterns:
      - pattern: strcpy($PASSWORD, $HARDCODED_PASSWORD);
      - pattern-not: |
          if (fgets($PASSWORD, 100, stdin) == NULL) {
            $ERROR_HANDLING;
          }