rules:
  - id: CWE256_Plaintext_Storage_of_Password__w32_char_02
    message: "Vulnerability detected: Plaintext password used in authentication without prior decryption."
    severity: ERROR
    metadata:
      cwe: "CWE256"
    languages: [c, cpp]
    patterns:
      - pattern: |
          if (LogonUserA(
              $USERNAME,
              $DOMAIN,
              $PASSWORD,
              $LOGON_TYPE,
              $LOGON_PROVIDER,
              &$PHANDLE) != 0) 
          {
              ...
          }
      - pattern-not: |
          if(!CryptAcquireContext(&$HCRYPTPROV, ..., ..., ..., ...))
          {
              ...
          }