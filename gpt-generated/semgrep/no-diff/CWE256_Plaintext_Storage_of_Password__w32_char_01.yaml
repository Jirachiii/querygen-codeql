rules:
  - id: CWE256_Plaintext_Storage_of_Password__w32_char_01
    message: "Detected use of plaintext password as per CWE256 vulnerability pattern"
    severity: ERROR
    metadata:
      cwe: "CWE256"
    languages: [c, cpp]
    patterns:
      - pattern: |
          if (LogonUserA(
              ...,
              $DATA,
              ...,
              LOGON32_LOGON_NETWORK,
              LOGON32_PROVIDER_DEFAULT,
              ...)) {
              ...
          }
      - pattern-not: |
          if(!CryptDecrypt(...)
          {
              ...
          }
          if (LogonUserA(
              ...,
              $DECRYPTED_DATA,
              ...,
              LOGON32_LOGON_NETWORK,
              LOGON32_PROVIDER_DEFAULT,
              ...)) {
              ...
          }