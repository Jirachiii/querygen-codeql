[
    {
        "file_path": "gpt-generated/CWE364_Signal_Handler_Race_Condition/CWE364_gpt_generated_part1.c",
        "source": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Mixing non-atomic operations with signal handlers in file I/O\nvoid vulnerable_file_io(void) {\n    FILE *f = fopen(\"data.txt\", \"w\");\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = 1;\n    signal(SIGUSR1, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 2;\n    });\n    if (f != NULL) {\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Free might be interrupted\n            globalStruct = NULL;\n        }\n        fclose(f);\n    }\n}\n\n// GOOD - Using mutex to ensure atomic operation during file I/O\nvoid safe_file_io(void) {\n    FILE *f = fopen(\"data.txt\", \"w\");\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = 1;\n    signal(SIGUSR1, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 2;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_unlock(&lock);\n    if (f != NULL) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Freed within a locked section\n            globalStruct = NULL;\n        }\n        pthread_mutex_unlock(&lock);\n        fclose(f);\n    }\n}\n",
        "ast": {
            "type": "translation_unit",
            "label": "",
            "pos": 0,
            "length": 1772,
            "snippet": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Mixing non-atomic operations with signal handlers in file I/O\nvoid vulnerable_file_io(void) {\n    FILE *f = fopen(\"data.txt\", \"w\");\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = 1;\n    signal(SIGUSR1, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 2;\n    });\n    if (f != NULL) {\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Free might be interrupted\n            globalStruct = NULL;\n        }\n        fclose(f);\n    }\n}\n\n// GOOD - Using mutex to ensure atomic operation during file I/O\nvoid safe_file_io(void) {\n    FILE *f = fopen(\"data.txt\", \"w\");\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = 1;\n    signal(SIGUSR1, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 2;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_unlock(&lock);\n    if (f != NULL) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Freed within a locked section\n            globalStruct = NULL;\n        }\n        pthread_mutex_unlock(&lock);\n        fclose(f);\n    }\n}",
            "children": [
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 0,
                    "length": 19,
                    "snippet": "#include <stdio.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 0,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdio.h>",
                            "pos": 9,
                            "length": 9,
                            "snippet": "<stdio.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 19,
                    "length": 20,
                    "snippet": "#include <stdlib.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 19,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdlib.h>",
                            "pos": 28,
                            "length": 10,
                            "snippet": "<stdlib.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 39,
                    "length": 20,
                    "snippet": "#include <signal.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 39,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<signal.h>",
                            "pos": 48,
                            "length": 10,
                            "snippet": "<signal.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 59,
                    "length": 20,
                    "snippet": "#include <unistd.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 59,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<unistd.h>",
                            "pos": 68,
                            "length": 10,
                            "snippet": "<unistd.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 79,
                    "length": 21,
                    "snippet": "#include <pthread.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 79,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<pthread.h>",
                            "pos": 88,
                            "length": 11,
                            "snippet": "<pthread.h>"
                        }
                    ]
                },
                {
                    "type": "type_definition",
                    "label": "",
                    "pos": 101,
                    "length": 48,
                    "snippet": "typedef struct {\n    int val;\n} structSigAtomic;",
                    "children": [
                        {
                            "type": "typedef",
                            "label": "typedef",
                            "pos": 101,
                            "length": 7,
                            "snippet": "typedef"
                        },
                        {
                            "type": "struct_specifier",
                            "label": "",
                            "pos": 109,
                            "length": 23,
                            "snippet": "struct {\n    int val;\n}",
                            "children": [
                                {
                                    "type": "struct",
                                    "label": "struct",
                                    "pos": 109,
                                    "length": 6,
                                    "snippet": "struct"
                                },
                                {
                                    "type": "field_declaration_list",
                                    "label": "",
                                    "pos": 116,
                                    "length": 16,
                                    "snippet": "{\n    int val;\n}",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 116,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "field_declaration",
                                            "label": "",
                                            "pos": 122,
                                            "length": 8,
                                            "snippet": "int val;",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "int",
                                                    "pos": 122,
                                                    "length": 3,
                                                    "snippet": "int"
                                                },
                                                {
                                                    "type": "field_identifier",
                                                    "label": "val",
                                                    "pos": 126,
                                                    "length": 3,
                                                    "snippet": "val"
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 129,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 131,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 133,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 148,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// Global variables used across multiple functions",
                    "pos": 151,
                    "length": 50,
                    "snippet": "// Global variables used across multiple functions"
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 202,
                    "length": 37,
                    "snippet": "volatile sig_atomic_t signalFlag = 0;",
                    "children": [
                        {
                            "type": "type_qualifier",
                            "label": "",
                            "pos": 202,
                            "length": 8,
                            "snippet": "volatile",
                            "children": [
                                {
                                    "type": "volatile",
                                    "label": "volatile",
                                    "pos": 202,
                                    "length": 8,
                                    "snippet": "volatile"
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "sig_atomic_t",
                            "pos": 211,
                            "length": 12,
                            "snippet": "sig_atomic_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 224,
                            "length": 14,
                            "snippet": "signalFlag = 0",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "signalFlag",
                                    "pos": 224,
                                    "length": 10,
                                    "snippet": "signalFlag"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 235,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "number_literal",
                                    "label": "0",
                                    "pos": 237,
                                    "length": 1,
                                    "snippet": "0"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 238,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 240,
                    "length": 37,
                    "snippet": "structSigAtomic *globalStruct = NULL;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 240,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 256,
                            "length": 20,
                            "snippet": "*globalStruct = NULL",
                            "children": [
                                {
                                    "type": "pointer_declarator",
                                    "label": "",
                                    "pos": 256,
                                    "length": 13,
                                    "snippet": "*globalStruct",
                                    "children": [
                                        {
                                            "type": "*",
                                            "label": "*",
                                            "pos": 256,
                                            "length": 1,
                                            "snippet": "*"
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "globalStruct",
                                            "pos": 257,
                                            "length": 12,
                                            "snippet": "globalStruct"
                                        }
                                    ]
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 270,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "null",
                                    "label": "",
                                    "pos": 272,
                                    "length": 4,
                                    "snippet": "NULL",
                                    "children": [
                                        {
                                            "type": "NULL",
                                            "label": "NULL",
                                            "pos": 272,
                                            "length": 4,
                                            "snippet": "NULL"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 276,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 278,
                    "length": 49,
                    "snippet": "pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "pthread_mutex_t",
                            "pos": 278,
                            "length": 15,
                            "snippet": "pthread_mutex_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 294,
                            "length": 32,
                            "snippet": "lock = PTHREAD_MUTEX_INITIALIZER",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "lock",
                                    "pos": 294,
                                    "length": 4,
                                    "snippet": "lock"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 299,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "identifier",
                                    "label": "PTHREAD_MUTEX_INITIALIZER",
                                    "pos": 301,
                                    "length": 25,
                                    "snippet": "PTHREAD_MUTEX_INITIALIZER"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 326,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// BAD - CWE-364: Mixing non-atomic operations with signal handlers in file I/O",
                    "pos": 329,
                    "length": 79,
                    "snippet": "// BAD - CWE-364: Mixing non-atomic operations with signal handlers in file I/O"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 409,
                    "length": 545,
                    "snippet": "void vulnerable_file_io(void) {\n    FILE *f = fopen(\"data.txt\", \"w\");\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = 1;\n    signal(SIGUSR1, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 2;\n    });\n    if (f != NULL) {\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Free might be interrupted\n            globalStruct = NULL;\n        }\n        fclose(f);\n    }\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 409,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 414,
                            "length": 24,
                            "snippet": "vulnerable_file_io(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "vulnerable_file_io",
                                    "pos": 414,
                                    "length": 18,
                                    "snippet": "vulnerable_file_io"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 432,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 432,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 433,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 433,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 437,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 439,
                            "length": 515,
                            "snippet": "{\n    FILE *f = fopen(\"data.txt\", \"w\");\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = 1;\n    signal(SIGUSR1, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 2;\n    });\n    if (f != NULL) {\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Free might be interrupted\n            globalStruct = NULL;\n        }\n        fclose(f);\n    }\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 439,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "declaration",
                                    "label": "",
                                    "pos": 445,
                                    "length": 33,
                                    "snippet": "FILE *f = fopen(\"data.txt\", \"w\");",
                                    "children": [
                                        {
                                            "type": "type_identifier",
                                            "label": "FILE",
                                            "pos": 445,
                                            "length": 4,
                                            "snippet": "FILE"
                                        },
                                        {
                                            "type": "init_declarator",
                                            "label": "",
                                            "pos": 450,
                                            "length": 27,
                                            "snippet": "*f = fopen(\"data.txt\", \"w\")",
                                            "children": [
                                                {
                                                    "type": "pointer_declarator",
                                                    "label": "",
                                                    "pos": 450,
                                                    "length": 2,
                                                    "snippet": "*f",
                                                    "children": [
                                                        {
                                                            "type": "*",
                                                            "label": "*",
                                                            "pos": 450,
                                                            "length": 1,
                                                            "snippet": "*"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "f",
                                                            "pos": 451,
                                                            "length": 1,
                                                            "snippet": "f"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 453,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 455,
                                                    "length": 22,
                                                    "snippet": "fopen(\"data.txt\", \"w\")",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "fopen",
                                                            "pos": 455,
                                                            "length": 5,
                                                            "snippet": "fopen"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 460,
                                                            "length": 17,
                                                            "snippet": "(\"data.txt\", \"w\")",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 460,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "string_literal",
                                                                    "label": "",
                                                                    "pos": 461,
                                                                    "length": 10,
                                                                    "snippet": "\"data.txt\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "\"",
                                                                            "label": "\"",
                                                                            "pos": 461,
                                                                            "length": 1,
                                                                            "snippet": "\""
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "data.txt",
                                                                            "pos": 462,
                                                                            "length": 8,
                                                                            "snippet": "data.txt"
                                                                        },
                                                                        {
                                                                            "type": "\"",
                                                                            "label": "\"",
                                                                            "pos": 470,
                                                                            "length": 1,
                                                                            "snippet": "\""
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ",",
                                                                    "label": ",",
                                                                    "pos": 471,
                                                                    "length": 1,
                                                                    "snippet": ","
                                                                },
                                                                {
                                                                    "type": "string_literal",
                                                                    "label": "",
                                                                    "pos": 473,
                                                                    "length": 3,
                                                                    "snippet": "\"w\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "\"",
                                                                            "label": "\"",
                                                                            "pos": 473,
                                                                            "length": 1,
                                                                            "snippet": "\""
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "w",
                                                                            "pos": 474,
                                                                            "length": 1,
                                                                            "snippet": "w"
                                                                        },
                                                                        {
                                                                            "type": "\"",
                                                                            "label": "\"",
                                                                            "pos": 475,
                                                                            "length": 1,
                                                                            "snippet": "\""
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 476,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 477,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 483,
                                    "length": 65,
                                    "snippet": "globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 483,
                                            "length": 64,
                                            "snippet": "globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic))",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "globalStruct",
                                                    "pos": 483,
                                                    "length": 12,
                                                    "snippet": "globalStruct"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 496,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 498,
                                                    "length": 49,
                                                    "snippet": "(structSigAtomic*)malloc(sizeof(structSigAtomic))",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 498,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 499,
                                                            "length": 16,
                                                            "snippet": "structSigAtomic*",
                                                            "children": [
                                                                {
                                                                    "type": "type_identifier",
                                                                    "label": "structSigAtomic",
                                                                    "pos": 499,
                                                                    "length": 15,
                                                                    "snippet": "structSigAtomic"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 514,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 514,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 515,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 516,
                                                            "length": 31,
                                                            "snippet": "malloc(sizeof(structSigAtomic))",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 516,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 522,
                                                                    "length": 25,
                                                                    "snippet": "(sizeof(structSigAtomic))",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 522,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "sizeof_expression",
                                                                            "label": "",
                                                                            "pos": 523,
                                                                            "length": 23,
                                                                            "snippet": "sizeof(structSigAtomic)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "sizeof",
                                                                                    "label": "sizeof",
                                                                                    "pos": 523,
                                                                                    "length": 6,
                                                                                    "snippet": "sizeof"
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "",
                                                                                    "pos": 529,
                                                                                    "length": 17,
                                                                                    "snippet": "(structSigAtomic)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 529,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "structSigAtomic",
                                                                                            "pos": 530,
                                                                                            "length": 15,
                                                                                            "snippet": "structSigAtomic"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 545,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 546,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 547,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 553,
                                    "length": 35,
                                    "snippet": "if (globalStruct == NULL) exit(-1);",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 553,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 556,
                                            "length": 22,
                                            "snippet": "(globalStruct == NULL)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 556,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 557,
                                                    "length": 20,
                                                    "snippet": "globalStruct == NULL",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 557,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "==",
                                                            "label": "==",
                                                            "pos": 570,
                                                            "length": 2,
                                                            "snippet": "=="
                                                        },
                                                        {
                                                            "type": "null",
                                                            "label": "",
                                                            "pos": 573,
                                                            "length": 4,
                                                            "snippet": "NULL",
                                                            "children": [
                                                                {
                                                                    "type": "NULL",
                                                                    "label": "NULL",
                                                                    "pos": 573,
                                                                    "length": 4,
                                                                    "snippet": "NULL"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 577,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 579,
                                            "length": 9,
                                            "snippet": "exit(-1);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 579,
                                                    "length": 8,
                                                    "snippet": "exit(-1)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "exit",
                                                            "pos": 579,
                                                            "length": 4,
                                                            "snippet": "exit"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 583,
                                                            "length": 4,
                                                            "snippet": "(-1)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 583,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "-1",
                                                                    "pos": 584,
                                                                    "length": 2,
                                                                    "snippet": "-1"
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 586,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 587,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 593,
                                    "length": 22,
                                    "snippet": "globalStruct->val = 1;",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 593,
                                            "length": 21,
                                            "snippet": "globalStruct->val = 1",
                                            "children": [
                                                {
                                                    "type": "field_expression",
                                                    "label": "",
                                                    "pos": 593,
                                                    "length": 17,
                                                    "snippet": "globalStruct->val",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 593,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "->",
                                                            "label": "->",
                                                            "pos": 605,
                                                            "length": 2,
                                                            "snippet": "->"
                                                        },
                                                        {
                                                            "type": "field_identifier",
                                                            "label": "val",
                                                            "pos": 607,
                                                            "length": 3,
                                                            "snippet": "val"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 611,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "number_literal",
                                                    "label": "1",
                                                    "pos": 613,
                                                    "length": 1,
                                                    "snippet": "1"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 614,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 620,
                                    "length": 27,
                                    "snippet": "signal(SIGUSR1, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 620,
                                            "length": 27,
                                            "snippet": "signal(SIGUSR1, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 620,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 626,
                                                    "length": 21,
                                                    "snippet": "(SIGUSR1, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 626,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGUSR1",
                                                            "pos": 627,
                                                            "length": 7,
                                                            "snippet": "SIGUSR1"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 634,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 636,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 636,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 637,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 638,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 639,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 643,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 646,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 647,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 648,
                                    "length": 64,
                                    "snippet": "{\n        if (globalStruct != NULL) globalStruct->val = 2;\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 648,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 658,
                                            "length": 48,
                                            "snippet": "if (globalStruct != NULL) globalStruct->val = 2;",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 658,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 661,
                                                    "length": 22,
                                                    "snippet": "(globalStruct != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 661,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 662,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 662,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 675,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 678,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 678,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 682,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 684,
                                                    "length": 22,
                                                    "snippet": "globalStruct->val = 2;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 684,
                                                            "length": 21,
                                                            "snippet": "globalStruct->val = 2",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 684,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 684,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 696,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 698,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 702,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "2",
                                                                    "pos": 704,
                                                                    "length": 1,
                                                                    "snippet": "2"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 705,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 711,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 712,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 712,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 713,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 713,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 719,
                                    "length": 233,
                                    "snippet": "if (f != NULL) {\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Free might be interrupted\n            globalStruct = NULL;\n        }\n        fclose(f);\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 719,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 722,
                                            "length": 11,
                                            "snippet": "(f != NULL)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 722,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 723,
                                                    "length": 9,
                                                    "snippet": "f != NULL",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "f",
                                                            "pos": 723,
                                                            "length": 1,
                                                            "snippet": "f"
                                                        },
                                                        {
                                                            "type": "!=",
                                                            "label": "!=",
                                                            "pos": 725,
                                                            "length": 2,
                                                            "snippet": "!="
                                                        },
                                                        {
                                                            "type": "null",
                                                            "label": "",
                                                            "pos": 728,
                                                            "length": 4,
                                                            "snippet": "NULL",
                                                            "children": [
                                                                {
                                                                    "type": "NULL",
                                                                    "label": "NULL",
                                                                    "pos": 728,
                                                                    "length": 4,
                                                                    "snippet": "NULL"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 732,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 734,
                                            "length": 218,
                                            "snippet": "{\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Free might be interrupted\n            globalStruct = NULL;\n        }\n        fclose(f);\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 734,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "label": "",
                                                    "pos": 744,
                                                    "length": 183,
                                                    "snippet": "if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Free might be interrupted\n            globalStruct = NULL;\n        }",
                                                    "children": [
                                                        {
                                                            "type": "if",
                                                            "label": "if",
                                                            "pos": 744,
                                                            "length": 2,
                                                            "snippet": "if"
                                                        },
                                                        {
                                                            "type": "parenthesized_expression",
                                                            "label": "",
                                                            "pos": 747,
                                                            "length": 22,
                                                            "snippet": "(globalStruct != NULL)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 747,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "binary_expression",
                                                                    "label": "",
                                                                    "pos": 748,
                                                                    "length": 20,
                                                                    "snippet": "globalStruct != NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 748,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "!=",
                                                                            "label": "!=",
                                                                            "pos": 761,
                                                                            "length": 2,
                                                                            "snippet": "!="
                                                                        },
                                                                        {
                                                                            "type": "null",
                                                                            "label": "",
                                                                            "pos": 764,
                                                                            "length": 4,
                                                                            "snippet": "NULL",
                                                                            "children": [
                                                                                {
                                                                                    "type": "NULL",
                                                                                    "label": "NULL",
                                                                                    "pos": 764,
                                                                                    "length": 4,
                                                                                    "snippet": "NULL"
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 768,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "compound_statement",
                                                            "label": "",
                                                            "pos": 770,
                                                            "length": 157,
                                                            "snippet": "{\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Free might be interrupted\n            globalStruct = NULL;\n        }",
                                                            "children": [
                                                                {
                                                                    "type": "{",
                                                                    "label": "{",
                                                                    "pos": 770,
                                                                    "length": 1,
                                                                    "snippet": "{"
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "",
                                                                    "pos": 784,
                                                                    "length": 38,
                                                                    "snippet": "fprintf(f, \"%d\\n\", globalStruct->val);",
                                                                    "children": [
                                                                        {
                                                                            "type": "call_expression",
                                                                            "label": "",
                                                                            "pos": 784,
                                                                            "length": 37,
                                                                            "snippet": "fprintf(f, \"%d\\n\", globalStruct->val)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "fprintf",
                                                                                    "pos": 784,
                                                                                    "length": 7,
                                                                                    "snippet": "fprintf"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "",
                                                                                    "pos": 791,
                                                                                    "length": 30,
                                                                                    "snippet": "(f, \"%d\\n\", globalStruct->val)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 791,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "f",
                                                                                            "pos": 792,
                                                                                            "length": 1,
                                                                                            "snippet": "f"
                                                                                        },
                                                                                        {
                                                                                            "type": ",",
                                                                                            "label": ",",
                                                                                            "pos": 793,
                                                                                            "length": 1,
                                                                                            "snippet": ","
                                                                                        },
                                                                                        {
                                                                                            "type": "string_literal",
                                                                                            "label": "",
                                                                                            "pos": 795,
                                                                                            "length": 6,
                                                                                            "snippet": "\"%d\\n\"",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "\"",
                                                                                                    "label": "\"",
                                                                                                    "pos": 795,
                                                                                                    "length": 1,
                                                                                                    "snippet": "\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "%d",
                                                                                                    "pos": 796,
                                                                                                    "length": 2,
                                                                                                    "snippet": "%d"
                                                                                                },
                                                                                                {
                                                                                                    "type": "escape_sequence",
                                                                                                    "label": "\\n",
                                                                                                    "pos": 798,
                                                                                                    "length": 2,
                                                                                                    "snippet": "\\n"
                                                                                                },
                                                                                                {
                                                                                                    "type": "\"",
                                                                                                    "label": "\"",
                                                                                                    "pos": 800,
                                                                                                    "length": 1,
                                                                                                    "snippet": "\""
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": ",",
                                                                                            "label": ",",
                                                                                            "pos": 801,
                                                                                            "length": 1,
                                                                                            "snippet": ","
                                                                                        },
                                                                                        {
                                                                                            "type": "field_expression",
                                                                                            "label": "",
                                                                                            "pos": 803,
                                                                                            "length": 17,
                                                                                            "snippet": "globalStruct->val",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "globalStruct",
                                                                                                    "pos": 803,
                                                                                                    "length": 12,
                                                                                                    "snippet": "globalStruct"
                                                                                                },
                                                                                                {
                                                                                                    "type": "->",
                                                                                                    "label": "->",
                                                                                                    "pos": 815,
                                                                                                    "length": 2,
                                                                                                    "snippet": "->"
                                                                                                },
                                                                                                {
                                                                                                    "type": "field_identifier",
                                                                                                    "label": "val",
                                                                                                    "pos": 817,
                                                                                                    "length": 3,
                                                                                                    "snippet": "val"
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 820,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ";",
                                                                            "label": ";",
                                                                            "pos": 821,
                                                                            "length": 1,
                                                                            "snippet": ";"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "",
                                                                    "pos": 835,
                                                                    "length": 19,
                                                                    "snippet": "free(globalStruct);",
                                                                    "children": [
                                                                        {
                                                                            "type": "call_expression",
                                                                            "label": "",
                                                                            "pos": 835,
                                                                            "length": 18,
                                                                            "snippet": "free(globalStruct)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "free",
                                                                                    "pos": 835,
                                                                                    "length": 4,
                                                                                    "snippet": "free"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "",
                                                                                    "pos": 839,
                                                                                    "length": 14,
                                                                                    "snippet": "(globalStruct)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 839,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "globalStruct",
                                                                                            "pos": 840,
                                                                                            "length": 12,
                                                                                            "snippet": "globalStruct"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 852,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ";",
                                                                            "label": ";",
                                                                            "pos": 853,
                                                                            "length": 1,
                                                                            "snippet": ";"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "// Free might be interrupted",
                                                                    "pos": 856,
                                                                    "length": 28,
                                                                    "snippet": "// Free might be interrupted"
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "",
                                                                    "pos": 897,
                                                                    "length": 20,
                                                                    "snippet": "globalStruct = NULL;",
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment_expression",
                                                                            "label": "",
                                                                            "pos": 897,
                                                                            "length": 19,
                                                                            "snippet": "globalStruct = NULL",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "globalStruct",
                                                                                    "pos": 897,
                                                                                    "length": 12,
                                                                                    "snippet": "globalStruct"
                                                                                },
                                                                                {
                                                                                    "type": "=",
                                                                                    "label": "=",
                                                                                    "pos": 910,
                                                                                    "length": 1,
                                                                                    "snippet": "="
                                                                                },
                                                                                {
                                                                                    "type": "null",
                                                                                    "label": "",
                                                                                    "pos": 912,
                                                                                    "length": 4,
                                                                                    "snippet": "NULL",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "NULL",
                                                                                            "label": "NULL",
                                                                                            "pos": 912,
                                                                                            "length": 4,
                                                                                            "snippet": "NULL"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ";",
                                                                            "label": ";",
                                                                            "pos": 916,
                                                                            "length": 1,
                                                                            "snippet": ";"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "}",
                                                                    "label": "}",
                                                                    "pos": 926,
                                                                    "length": 1,
                                                                    "snippet": "}"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 936,
                                                    "length": 10,
                                                    "snippet": "fclose(f);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 936,
                                                            "length": 9,
                                                            "snippet": "fclose(f)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "fclose",
                                                                    "pos": 936,
                                                                    "length": 6,
                                                                    "snippet": "fclose"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 942,
                                                                    "length": 3,
                                                                    "snippet": "(f)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 942,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "f",
                                                                            "pos": 943,
                                                                            "length": 1,
                                                                            "snippet": "f"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 944,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 945,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 951,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 953,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// GOOD - Using mutex to ensure atomic operation during file I/O",
                    "pos": 956,
                    "length": 64,
                    "snippet": "// GOOD - Using mutex to ensure atomic operation during file I/O"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 1021,
                    "length": 751,
                    "snippet": "void safe_file_io(void) {\n    FILE *f = fopen(\"data.txt\", \"w\");\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = 1;\n    signal(SIGUSR1, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 2;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_unlock(&lock);\n    if (f != NULL) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Freed within a locked section\n            globalStruct = NULL;\n        }\n        pthread_mutex_unlock(&lock);\n        fclose(f);\n    }\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 1021,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 1026,
                            "length": 18,
                            "snippet": "safe_file_io(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "safe_file_io",
                                    "pos": 1026,
                                    "length": 12,
                                    "snippet": "safe_file_io"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 1038,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 1038,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 1039,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 1039,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 1043,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 1045,
                            "length": 727,
                            "snippet": "{\n    FILE *f = fopen(\"data.txt\", \"w\");\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = 1;\n    signal(SIGUSR1, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 2;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_unlock(&lock);\n    if (f != NULL) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Freed within a locked section\n            globalStruct = NULL;\n        }\n        pthread_mutex_unlock(&lock);\n        fclose(f);\n    }\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 1045,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "declaration",
                                    "label": "",
                                    "pos": 1051,
                                    "length": 33,
                                    "snippet": "FILE *f = fopen(\"data.txt\", \"w\");",
                                    "children": [
                                        {
                                            "type": "type_identifier",
                                            "label": "FILE",
                                            "pos": 1051,
                                            "length": 4,
                                            "snippet": "FILE"
                                        },
                                        {
                                            "type": "init_declarator",
                                            "label": "",
                                            "pos": 1056,
                                            "length": 27,
                                            "snippet": "*f = fopen(\"data.txt\", \"w\")",
                                            "children": [
                                                {
                                                    "type": "pointer_declarator",
                                                    "label": "",
                                                    "pos": 1056,
                                                    "length": 2,
                                                    "snippet": "*f",
                                                    "children": [
                                                        {
                                                            "type": "*",
                                                            "label": "*",
                                                            "pos": 1056,
                                                            "length": 1,
                                                            "snippet": "*"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "f",
                                                            "pos": 1057,
                                                            "length": 1,
                                                            "snippet": "f"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 1059,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1061,
                                                    "length": 22,
                                                    "snippet": "fopen(\"data.txt\", \"w\")",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "fopen",
                                                            "pos": 1061,
                                                            "length": 5,
                                                            "snippet": "fopen"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1066,
                                                            "length": 17,
                                                            "snippet": "(\"data.txt\", \"w\")",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1066,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "string_literal",
                                                                    "label": "",
                                                                    "pos": 1067,
                                                                    "length": 10,
                                                                    "snippet": "\"data.txt\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "\"",
                                                                            "label": "\"",
                                                                            "pos": 1067,
                                                                            "length": 1,
                                                                            "snippet": "\""
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "data.txt",
                                                                            "pos": 1068,
                                                                            "length": 8,
                                                                            "snippet": "data.txt"
                                                                        },
                                                                        {
                                                                            "type": "\"",
                                                                            "label": "\"",
                                                                            "pos": 1076,
                                                                            "length": 1,
                                                                            "snippet": "\""
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ",",
                                                                    "label": ",",
                                                                    "pos": 1077,
                                                                    "length": 1,
                                                                    "snippet": ","
                                                                },
                                                                {
                                                                    "type": "string_literal",
                                                                    "label": "",
                                                                    "pos": 1079,
                                                                    "length": 3,
                                                                    "snippet": "\"w\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "\"",
                                                                            "label": "\"",
                                                                            "pos": 1079,
                                                                            "length": 1,
                                                                            "snippet": "\""
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "w",
                                                                            "pos": 1080,
                                                                            "length": 1,
                                                                            "snippet": "w"
                                                                        },
                                                                        {
                                                                            "type": "\"",
                                                                            "label": "\"",
                                                                            "pos": 1081,
                                                                            "length": 1,
                                                                            "snippet": "\""
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1082,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1083,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1089,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1089,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 1089,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1107,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1107,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1108,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1108,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1109,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1113,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1114,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1120,
                                    "length": 65,
                                    "snippet": "globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 1120,
                                            "length": 64,
                                            "snippet": "globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic))",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "globalStruct",
                                                    "pos": 1120,
                                                    "length": 12,
                                                    "snippet": "globalStruct"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 1133,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 1135,
                                                    "length": 49,
                                                    "snippet": "(structSigAtomic*)malloc(sizeof(structSigAtomic))",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1135,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 1136,
                                                            "length": 16,
                                                            "snippet": "structSigAtomic*",
                                                            "children": [
                                                                {
                                                                    "type": "type_identifier",
                                                                    "label": "structSigAtomic",
                                                                    "pos": 1136,
                                                                    "length": 15,
                                                                    "snippet": "structSigAtomic"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 1151,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 1151,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1152,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1153,
                                                            "length": 31,
                                                            "snippet": "malloc(sizeof(structSigAtomic))",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 1153,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1159,
                                                                    "length": 25,
                                                                    "snippet": "(sizeof(structSigAtomic))",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1159,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "sizeof_expression",
                                                                            "label": "",
                                                                            "pos": 1160,
                                                                            "length": 23,
                                                                            "snippet": "sizeof(structSigAtomic)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "sizeof",
                                                                                    "label": "sizeof",
                                                                                    "pos": 1160,
                                                                                    "length": 6,
                                                                                    "snippet": "sizeof"
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "",
                                                                                    "pos": 1166,
                                                                                    "length": 17,
                                                                                    "snippet": "(structSigAtomic)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 1166,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "structSigAtomic",
                                                                                            "pos": 1167,
                                                                                            "length": 15,
                                                                                            "snippet": "structSigAtomic"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 1182,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1183,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1184,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 1190,
                                    "length": 35,
                                    "snippet": "if (globalStruct == NULL) exit(-1);",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 1190,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 1193,
                                            "length": 22,
                                            "snippet": "(globalStruct == NULL)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 1193,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 1194,
                                                    "length": 20,
                                                    "snippet": "globalStruct == NULL",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 1194,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "==",
                                                            "label": "==",
                                                            "pos": 1207,
                                                            "length": 2,
                                                            "snippet": "=="
                                                        },
                                                        {
                                                            "type": "null",
                                                            "label": "",
                                                            "pos": 1210,
                                                            "length": 4,
                                                            "snippet": "NULL",
                                                            "children": [
                                                                {
                                                                    "type": "NULL",
                                                                    "label": "NULL",
                                                                    "pos": 1210,
                                                                    "length": 4,
                                                                    "snippet": "NULL"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 1214,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1216,
                                            "length": 9,
                                            "snippet": "exit(-1);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1216,
                                                    "length": 8,
                                                    "snippet": "exit(-1)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "exit",
                                                            "pos": 1216,
                                                            "length": 4,
                                                            "snippet": "exit"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1220,
                                                            "length": 4,
                                                            "snippet": "(-1)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1220,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "-1",
                                                                    "pos": 1221,
                                                                    "length": 2,
                                                                    "snippet": "-1"
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1223,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1224,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1230,
                                    "length": 22,
                                    "snippet": "globalStruct->val = 1;",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 1230,
                                            "length": 21,
                                            "snippet": "globalStruct->val = 1",
                                            "children": [
                                                {
                                                    "type": "field_expression",
                                                    "label": "",
                                                    "pos": 1230,
                                                    "length": 17,
                                                    "snippet": "globalStruct->val",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 1230,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "->",
                                                            "label": "->",
                                                            "pos": 1242,
                                                            "length": 2,
                                                            "snippet": "->"
                                                        },
                                                        {
                                                            "type": "field_identifier",
                                                            "label": "val",
                                                            "pos": 1244,
                                                            "length": 3,
                                                            "snippet": "val"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 1248,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "number_literal",
                                                    "label": "1",
                                                    "pos": 1250,
                                                    "length": 1,
                                                    "snippet": "1"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1251,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1257,
                                    "length": 27,
                                    "snippet": "signal(SIGUSR1, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1257,
                                            "length": 27,
                                            "snippet": "signal(SIGUSR1, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 1257,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1263,
                                                    "length": 21,
                                                    "snippet": "(SIGUSR1, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1263,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGUSR1",
                                                            "pos": 1264,
                                                            "length": 7,
                                                            "snippet": "SIGUSR1"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 1271,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 1273,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 1273,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 1274,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1275,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 1276,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 1280,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1283,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 1284,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 1285,
                                    "length": 136,
                                    "snippet": "{\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 2;\n        pthread_mutex_unlock(&lock);\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 1285,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1295,
                                            "length": 26,
                                            "snippet": "pthread_mutex_lock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1295,
                                                    "length": 25,
                                                    "snippet": "pthread_mutex_lock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_lock",
                                                            "pos": 1295,
                                                            "length": 18,
                                                            "snippet": "pthread_mutex_lock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1313,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1313,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1314,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1314,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1315,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1319,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1320,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 1330,
                                            "length": 48,
                                            "snippet": "if (globalStruct != NULL) globalStruct->val = 2;",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 1330,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 1333,
                                                    "length": 22,
                                                    "snippet": "(globalStruct != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1333,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 1334,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1334,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 1347,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1350,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1350,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1354,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1356,
                                                    "length": 22,
                                                    "snippet": "globalStruct->val = 2;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1356,
                                                            "length": 21,
                                                            "snippet": "globalStruct->val = 2",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 1356,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1356,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 1368,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 1370,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1374,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "2",
                                                                    "pos": 1376,
                                                                    "length": 1,
                                                                    "snippet": "2"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1377,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1387,
                                            "length": 28,
                                            "snippet": "pthread_mutex_unlock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1387,
                                                    "length": 27,
                                                    "snippet": "pthread_mutex_unlock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_unlock",
                                                            "pos": 1387,
                                                            "length": 20,
                                                            "snippet": "pthread_mutex_unlock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1407,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1407,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1408,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1408,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1409,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1413,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1414,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 1420,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 1421,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 1421,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1422,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1422,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1428,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1428,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 1428,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1448,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1448,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1449,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1449,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1450,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1454,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1455,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 1461,
                                    "length": 309,
                                    "snippet": "if (f != NULL) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Freed within a locked section\n            globalStruct = NULL;\n        }\n        pthread_mutex_unlock(&lock);\n        fclose(f);\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 1461,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 1464,
                                            "length": 11,
                                            "snippet": "(f != NULL)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 1464,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 1465,
                                                    "length": 9,
                                                    "snippet": "f != NULL",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "f",
                                                            "pos": 1465,
                                                            "length": 1,
                                                            "snippet": "f"
                                                        },
                                                        {
                                                            "type": "!=",
                                                            "label": "!=",
                                                            "pos": 1467,
                                                            "length": 2,
                                                            "snippet": "!="
                                                        },
                                                        {
                                                            "type": "null",
                                                            "label": "",
                                                            "pos": 1470,
                                                            "length": 4,
                                                            "snippet": "NULL",
                                                            "children": [
                                                                {
                                                                    "type": "NULL",
                                                                    "label": "NULL",
                                                                    "pos": 1470,
                                                                    "length": 4,
                                                                    "snippet": "NULL"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 1474,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 1476,
                                            "length": 294,
                                            "snippet": "{\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Freed within a locked section\n            globalStruct = NULL;\n        }\n        pthread_mutex_unlock(&lock);\n        fclose(f);\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 1476,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1486,
                                                    "length": 26,
                                                    "snippet": "pthread_mutex_lock(&lock);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1486,
                                                            "length": 25,
                                                            "snippet": "pthread_mutex_lock(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "pthread_mutex_lock",
                                                                    "pos": 1486,
                                                                    "length": 18,
                                                                    "snippet": "pthread_mutex_lock"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1504,
                                                                    "length": 7,
                                                                    "snippet": "(&lock)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1504,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "pointer_expression",
                                                                            "label": "",
                                                                            "pos": 1505,
                                                                            "length": 5,
                                                                            "snippet": "&lock",
                                                                            "children": [
                                                                                {
                                                                                    "type": "&",
                                                                                    "label": "&",
                                                                                    "pos": 1505,
                                                                                    "length": 1,
                                                                                    "snippet": "&"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "lock",
                                                                                    "pos": 1506,
                                                                                    "length": 4,
                                                                                    "snippet": "lock"
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1510,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1511,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "label": "",
                                                    "pos": 1521,
                                                    "length": 187,
                                                    "snippet": "if (globalStruct != NULL) {\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Freed within a locked section\n            globalStruct = NULL;\n        }",
                                                    "children": [
                                                        {
                                                            "type": "if",
                                                            "label": "if",
                                                            "pos": 1521,
                                                            "length": 2,
                                                            "snippet": "if"
                                                        },
                                                        {
                                                            "type": "parenthesized_expression",
                                                            "label": "",
                                                            "pos": 1524,
                                                            "length": 22,
                                                            "snippet": "(globalStruct != NULL)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1524,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "binary_expression",
                                                                    "label": "",
                                                                    "pos": 1525,
                                                                    "length": 20,
                                                                    "snippet": "globalStruct != NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1525,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "!=",
                                                                            "label": "!=",
                                                                            "pos": 1538,
                                                                            "length": 2,
                                                                            "snippet": "!="
                                                                        },
                                                                        {
                                                                            "type": "null",
                                                                            "label": "",
                                                                            "pos": 1541,
                                                                            "length": 4,
                                                                            "snippet": "NULL",
                                                                            "children": [
                                                                                {
                                                                                    "type": "NULL",
                                                                                    "label": "NULL",
                                                                                    "pos": 1541,
                                                                                    "length": 4,
                                                                                    "snippet": "NULL"
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1545,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "compound_statement",
                                                            "label": "",
                                                            "pos": 1547,
                                                            "length": 161,
                                                            "snippet": "{\n            fprintf(f, \"%d\\n\", globalStruct->val);\n            free(globalStruct);  // Freed within a locked section\n            globalStruct = NULL;\n        }",
                                                            "children": [
                                                                {
                                                                    "type": "{",
                                                                    "label": "{",
                                                                    "pos": 1547,
                                                                    "length": 1,
                                                                    "snippet": "{"
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "",
                                                                    "pos": 1561,
                                                                    "length": 38,
                                                                    "snippet": "fprintf(f, \"%d\\n\", globalStruct->val);",
                                                                    "children": [
                                                                        {
                                                                            "type": "call_expression",
                                                                            "label": "",
                                                                            "pos": 1561,
                                                                            "length": 37,
                                                                            "snippet": "fprintf(f, \"%d\\n\", globalStruct->val)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "fprintf",
                                                                                    "pos": 1561,
                                                                                    "length": 7,
                                                                                    "snippet": "fprintf"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "",
                                                                                    "pos": 1568,
                                                                                    "length": 30,
                                                                                    "snippet": "(f, \"%d\\n\", globalStruct->val)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 1568,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "f",
                                                                                            "pos": 1569,
                                                                                            "length": 1,
                                                                                            "snippet": "f"
                                                                                        },
                                                                                        {
                                                                                            "type": ",",
                                                                                            "label": ",",
                                                                                            "pos": 1570,
                                                                                            "length": 1,
                                                                                            "snippet": ","
                                                                                        },
                                                                                        {
                                                                                            "type": "string_literal",
                                                                                            "label": "",
                                                                                            "pos": 1572,
                                                                                            "length": 6,
                                                                                            "snippet": "\"%d\\n\"",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "\"",
                                                                                                    "label": "\"",
                                                                                                    "pos": 1572,
                                                                                                    "length": 1,
                                                                                                    "snippet": "\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "%d",
                                                                                                    "pos": 1573,
                                                                                                    "length": 2,
                                                                                                    "snippet": "%d"
                                                                                                },
                                                                                                {
                                                                                                    "type": "escape_sequence",
                                                                                                    "label": "\\n",
                                                                                                    "pos": 1575,
                                                                                                    "length": 2,
                                                                                                    "snippet": "\\n"
                                                                                                },
                                                                                                {
                                                                                                    "type": "\"",
                                                                                                    "label": "\"",
                                                                                                    "pos": 1577,
                                                                                                    "length": 1,
                                                                                                    "snippet": "\""
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": ",",
                                                                                            "label": ",",
                                                                                            "pos": 1578,
                                                                                            "length": 1,
                                                                                            "snippet": ","
                                                                                        },
                                                                                        {
                                                                                            "type": "field_expression",
                                                                                            "label": "",
                                                                                            "pos": 1580,
                                                                                            "length": 17,
                                                                                            "snippet": "globalStruct->val",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "globalStruct",
                                                                                                    "pos": 1580,
                                                                                                    "length": 12,
                                                                                                    "snippet": "globalStruct"
                                                                                                },
                                                                                                {
                                                                                                    "type": "->",
                                                                                                    "label": "->",
                                                                                                    "pos": 1592,
                                                                                                    "length": 2,
                                                                                                    "snippet": "->"
                                                                                                },
                                                                                                {
                                                                                                    "type": "field_identifier",
                                                                                                    "label": "val",
                                                                                                    "pos": 1594,
                                                                                                    "length": 3,
                                                                                                    "snippet": "val"
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 1597,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ";",
                                                                            "label": ";",
                                                                            "pos": 1598,
                                                                            "length": 1,
                                                                            "snippet": ";"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "",
                                                                    "pos": 1612,
                                                                    "length": 19,
                                                                    "snippet": "free(globalStruct);",
                                                                    "children": [
                                                                        {
                                                                            "type": "call_expression",
                                                                            "label": "",
                                                                            "pos": 1612,
                                                                            "length": 18,
                                                                            "snippet": "free(globalStruct)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "free",
                                                                                    "pos": 1612,
                                                                                    "length": 4,
                                                                                    "snippet": "free"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "",
                                                                                    "pos": 1616,
                                                                                    "length": 14,
                                                                                    "snippet": "(globalStruct)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 1616,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "globalStruct",
                                                                                            "pos": 1617,
                                                                                            "length": 12,
                                                                                            "snippet": "globalStruct"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 1629,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ";",
                                                                            "label": ";",
                                                                            "pos": 1630,
                                                                            "length": 1,
                                                                            "snippet": ";"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "// Freed within a locked section",
                                                                    "pos": 1633,
                                                                    "length": 32,
                                                                    "snippet": "// Freed within a locked section"
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "",
                                                                    "pos": 1678,
                                                                    "length": 20,
                                                                    "snippet": "globalStruct = NULL;",
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment_expression",
                                                                            "label": "",
                                                                            "pos": 1678,
                                                                            "length": 19,
                                                                            "snippet": "globalStruct = NULL",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "globalStruct",
                                                                                    "pos": 1678,
                                                                                    "length": 12,
                                                                                    "snippet": "globalStruct"
                                                                                },
                                                                                {
                                                                                    "type": "=",
                                                                                    "label": "=",
                                                                                    "pos": 1691,
                                                                                    "length": 1,
                                                                                    "snippet": "="
                                                                                },
                                                                                {
                                                                                    "type": "null",
                                                                                    "label": "",
                                                                                    "pos": 1693,
                                                                                    "length": 4,
                                                                                    "snippet": "NULL",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "NULL",
                                                                                            "label": "NULL",
                                                                                            "pos": 1693,
                                                                                            "length": 4,
                                                                                            "snippet": "NULL"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ";",
                                                                            "label": ";",
                                                                            "pos": 1697,
                                                                            "length": 1,
                                                                            "snippet": ";"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "}",
                                                                    "label": "}",
                                                                    "pos": 1707,
                                                                    "length": 1,
                                                                    "snippet": "}"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1717,
                                                    "length": 28,
                                                    "snippet": "pthread_mutex_unlock(&lock);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1717,
                                                            "length": 27,
                                                            "snippet": "pthread_mutex_unlock(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "pthread_mutex_unlock",
                                                                    "pos": 1717,
                                                                    "length": 20,
                                                                    "snippet": "pthread_mutex_unlock"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1737,
                                                                    "length": 7,
                                                                    "snippet": "(&lock)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1737,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "pointer_expression",
                                                                            "label": "",
                                                                            "pos": 1738,
                                                                            "length": 5,
                                                                            "snippet": "&lock",
                                                                            "children": [
                                                                                {
                                                                                    "type": "&",
                                                                                    "label": "&",
                                                                                    "pos": 1738,
                                                                                    "length": 1,
                                                                                    "snippet": "&"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "lock",
                                                                                    "pos": 1739,
                                                                                    "length": 4,
                                                                                    "snippet": "lock"
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1743,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1744,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1754,
                                                    "length": 10,
                                                    "snippet": "fclose(f);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1754,
                                                            "length": 9,
                                                            "snippet": "fclose(f)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "fclose",
                                                                    "pos": 1754,
                                                                    "length": 6,
                                                                    "snippet": "fclose"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1760,
                                                                    "length": 3,
                                                                    "snippet": "(f)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1760,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "f",
                                                                            "pos": 1761,
                                                                            "length": 1,
                                                                            "snippet": "f"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1762,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1763,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 1769,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 1771,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    {
        "file_path": "gpt-generated/CWE364_Signal_Handler_Race_Condition/CWE364_gpt_generated_part2.c",
        "source": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Access shared variable without protection in network ops\nvoid vulnerable_network_op(void) {\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = sock;\n    signal(SIGTERM, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = -1;\n    });\n    // Pretend to do some network operations here\n    if (globalStruct->val != -1) {  // Might be changed in the middle\n        close(globalStruct->val);\n        free(globalStruct);\n        globalStruct = NULL;\n    }\n}\n\n// GOOD - Uses signal-safe variables and checks in network ops\nvoid safe_network_op(void) {\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = sock;\n    signal(SIGTERM, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = -1;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_unlock(&lock);\n    // Pretend to do some network operations here\n    pthread_mutex_lock(&lock);\n    if (globalStruct->val != -1) {\n        close(globalStruct->val);\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}\n",
        "ast": {
            "type": "translation_unit",
            "label": "",
            "pos": 0,
            "length": 1744,
            "snippet": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Access shared variable without protection in network ops\nvoid vulnerable_network_op(void) {\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = sock;\n    signal(SIGTERM, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = -1;\n    });\n    // Pretend to do some network operations here\n    if (globalStruct->val != -1) {  // Might be changed in the middle\n        close(globalStruct->val);\n        free(globalStruct);\n        globalStruct = NULL;\n    }\n}\n\n// GOOD - Uses signal-safe variables and checks in network ops\nvoid safe_network_op(void) {\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = sock;\n    signal(SIGTERM, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = -1;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_unlock(&lock);\n    // Pretend to do some network operations here\n    pthread_mutex_lock(&lock);\n    if (globalStruct->val != -1) {\n        close(globalStruct->val);\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
            "children": [
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 0,
                    "length": 19,
                    "snippet": "#include <stdio.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 0,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdio.h>",
                            "pos": 9,
                            "length": 9,
                            "snippet": "<stdio.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 19,
                    "length": 20,
                    "snippet": "#include <stdlib.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 19,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdlib.h>",
                            "pos": 28,
                            "length": 10,
                            "snippet": "<stdlib.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 39,
                    "length": 20,
                    "snippet": "#include <signal.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 39,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<signal.h>",
                            "pos": 48,
                            "length": 10,
                            "snippet": "<signal.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 59,
                    "length": 20,
                    "snippet": "#include <unistd.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 59,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<unistd.h>",
                            "pos": 68,
                            "length": 10,
                            "snippet": "<unistd.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 79,
                    "length": 21,
                    "snippet": "#include <pthread.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 79,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<pthread.h>",
                            "pos": 88,
                            "length": 11,
                            "snippet": "<pthread.h>"
                        }
                    ]
                },
                {
                    "type": "type_definition",
                    "label": "",
                    "pos": 101,
                    "length": 48,
                    "snippet": "typedef struct {\n    int val;\n} structSigAtomic;",
                    "children": [
                        {
                            "type": "typedef",
                            "label": "typedef",
                            "pos": 101,
                            "length": 7,
                            "snippet": "typedef"
                        },
                        {
                            "type": "struct_specifier",
                            "label": "",
                            "pos": 109,
                            "length": 23,
                            "snippet": "struct {\n    int val;\n}",
                            "children": [
                                {
                                    "type": "struct",
                                    "label": "struct",
                                    "pos": 109,
                                    "length": 6,
                                    "snippet": "struct"
                                },
                                {
                                    "type": "field_declaration_list",
                                    "label": "",
                                    "pos": 116,
                                    "length": 16,
                                    "snippet": "{\n    int val;\n}",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 116,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "field_declaration",
                                            "label": "",
                                            "pos": 122,
                                            "length": 8,
                                            "snippet": "int val;",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "int",
                                                    "pos": 122,
                                                    "length": 3,
                                                    "snippet": "int"
                                                },
                                                {
                                                    "type": "field_identifier",
                                                    "label": "val",
                                                    "pos": 126,
                                                    "length": 3,
                                                    "snippet": "val"
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 129,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 131,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 133,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 148,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// Global variables used across multiple functions",
                    "pos": 151,
                    "length": 50,
                    "snippet": "// Global variables used across multiple functions"
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 202,
                    "length": 37,
                    "snippet": "volatile sig_atomic_t signalFlag = 0;",
                    "children": [
                        {
                            "type": "type_qualifier",
                            "label": "",
                            "pos": 202,
                            "length": 8,
                            "snippet": "volatile",
                            "children": [
                                {
                                    "type": "volatile",
                                    "label": "volatile",
                                    "pos": 202,
                                    "length": 8,
                                    "snippet": "volatile"
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "sig_atomic_t",
                            "pos": 211,
                            "length": 12,
                            "snippet": "sig_atomic_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 224,
                            "length": 14,
                            "snippet": "signalFlag = 0",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "signalFlag",
                                    "pos": 224,
                                    "length": 10,
                                    "snippet": "signalFlag"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 235,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "number_literal",
                                    "label": "0",
                                    "pos": 237,
                                    "length": 1,
                                    "snippet": "0"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 238,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 240,
                    "length": 37,
                    "snippet": "structSigAtomic *globalStruct = NULL;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 240,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 256,
                            "length": 20,
                            "snippet": "*globalStruct = NULL",
                            "children": [
                                {
                                    "type": "pointer_declarator",
                                    "label": "",
                                    "pos": 256,
                                    "length": 13,
                                    "snippet": "*globalStruct",
                                    "children": [
                                        {
                                            "type": "*",
                                            "label": "*",
                                            "pos": 256,
                                            "length": 1,
                                            "snippet": "*"
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "globalStruct",
                                            "pos": 257,
                                            "length": 12,
                                            "snippet": "globalStruct"
                                        }
                                    ]
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 270,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "null",
                                    "label": "",
                                    "pos": 272,
                                    "length": 4,
                                    "snippet": "NULL",
                                    "children": [
                                        {
                                            "type": "NULL",
                                            "label": "NULL",
                                            "pos": 272,
                                            "length": 4,
                                            "snippet": "NULL"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 276,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 278,
                    "length": 49,
                    "snippet": "pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "pthread_mutex_t",
                            "pos": 278,
                            "length": 15,
                            "snippet": "pthread_mutex_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 294,
                            "length": 32,
                            "snippet": "lock = PTHREAD_MUTEX_INITIALIZER",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "lock",
                                    "pos": 294,
                                    "length": 4,
                                    "snippet": "lock"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 299,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "identifier",
                                    "label": "PTHREAD_MUTEX_INITIALIZER",
                                    "pos": 301,
                                    "length": 25,
                                    "snippet": "PTHREAD_MUTEX_INITIALIZER"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 326,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// BAD - CWE-364: Access shared variable without protection in network ops",
                    "pos": 329,
                    "length": 74,
                    "snippet": "// BAD - CWE-364: Access shared variable without protection in network ops"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 404,
                    "length": 541,
                    "snippet": "void vulnerable_network_op(void) {\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = sock;\n    signal(SIGTERM, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = -1;\n    });\n    // Pretend to do some network operations here\n    if (globalStruct->val != -1) {  // Might be changed in the middle\n        close(globalStruct->val);\n        free(globalStruct);\n        globalStruct = NULL;\n    }\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 404,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 409,
                            "length": 27,
                            "snippet": "vulnerable_network_op(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "vulnerable_network_op",
                                    "pos": 409,
                                    "length": 21,
                                    "snippet": "vulnerable_network_op"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 430,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 430,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 431,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 431,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 435,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 437,
                            "length": 508,
                            "snippet": "{\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = sock;\n    signal(SIGTERM, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = -1;\n    });\n    // Pretend to do some network operations here\n    if (globalStruct->val != -1) {  // Might be changed in the middle\n        close(globalStruct->val);\n        free(globalStruct);\n        globalStruct = NULL;\n    }\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 437,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "declaration",
                                    "label": "",
                                    "pos": 443,
                                    "length": 43,
                                    "snippet": "int sock = socket(AF_INET, SOCK_STREAM, 0);",
                                    "children": [
                                        {
                                            "type": "primitive_type",
                                            "label": "int",
                                            "pos": 443,
                                            "length": 3,
                                            "snippet": "int"
                                        },
                                        {
                                            "type": "init_declarator",
                                            "label": "",
                                            "pos": 447,
                                            "length": 38,
                                            "snippet": "sock = socket(AF_INET, SOCK_STREAM, 0)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "sock",
                                                    "pos": 447,
                                                    "length": 4,
                                                    "snippet": "sock"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 452,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 454,
                                                    "length": 31,
                                                    "snippet": "socket(AF_INET, SOCK_STREAM, 0)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "socket",
                                                            "pos": 454,
                                                            "length": 6,
                                                            "snippet": "socket"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 460,
                                                            "length": 25,
                                                            "snippet": "(AF_INET, SOCK_STREAM, 0)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 460,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "AF_INET",
                                                                    "pos": 461,
                                                                    "length": 7,
                                                                    "snippet": "AF_INET"
                                                                },
                                                                {
                                                                    "type": ",",
                                                                    "label": ",",
                                                                    "pos": 468,
                                                                    "length": 1,
                                                                    "snippet": ","
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "SOCK_STREAM",
                                                                    "pos": 470,
                                                                    "length": 11,
                                                                    "snippet": "SOCK_STREAM"
                                                                },
                                                                {
                                                                    "type": ",",
                                                                    "label": ",",
                                                                    "pos": 481,
                                                                    "length": 1,
                                                                    "snippet": ","
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "0",
                                                                    "pos": 483,
                                                                    "length": 1,
                                                                    "snippet": "0"
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 484,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 485,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 491,
                                    "length": 65,
                                    "snippet": "globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 491,
                                            "length": 64,
                                            "snippet": "globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic))",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "globalStruct",
                                                    "pos": 491,
                                                    "length": 12,
                                                    "snippet": "globalStruct"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 504,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 506,
                                                    "length": 49,
                                                    "snippet": "(structSigAtomic*)malloc(sizeof(structSigAtomic))",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 506,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 507,
                                                            "length": 16,
                                                            "snippet": "structSigAtomic*",
                                                            "children": [
                                                                {
                                                                    "type": "type_identifier",
                                                                    "label": "structSigAtomic",
                                                                    "pos": 507,
                                                                    "length": 15,
                                                                    "snippet": "structSigAtomic"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 522,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 522,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 523,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 524,
                                                            "length": 31,
                                                            "snippet": "malloc(sizeof(structSigAtomic))",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 524,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 530,
                                                                    "length": 25,
                                                                    "snippet": "(sizeof(structSigAtomic))",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 530,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "sizeof_expression",
                                                                            "label": "",
                                                                            "pos": 531,
                                                                            "length": 23,
                                                                            "snippet": "sizeof(structSigAtomic)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "sizeof",
                                                                                    "label": "sizeof",
                                                                                    "pos": 531,
                                                                                    "length": 6,
                                                                                    "snippet": "sizeof"
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "",
                                                                                    "pos": 537,
                                                                                    "length": 17,
                                                                                    "snippet": "(structSigAtomic)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 537,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "structSigAtomic",
                                                                                            "pos": 538,
                                                                                            "length": 15,
                                                                                            "snippet": "structSigAtomic"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 553,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 554,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 555,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 561,
                                    "length": 35,
                                    "snippet": "if (globalStruct == NULL) exit(-1);",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 561,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 564,
                                            "length": 22,
                                            "snippet": "(globalStruct == NULL)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 564,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 565,
                                                    "length": 20,
                                                    "snippet": "globalStruct == NULL",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 565,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "==",
                                                            "label": "==",
                                                            "pos": 578,
                                                            "length": 2,
                                                            "snippet": "=="
                                                        },
                                                        {
                                                            "type": "null",
                                                            "label": "",
                                                            "pos": 581,
                                                            "length": 4,
                                                            "snippet": "NULL",
                                                            "children": [
                                                                {
                                                                    "type": "NULL",
                                                                    "label": "NULL",
                                                                    "pos": 581,
                                                                    "length": 4,
                                                                    "snippet": "NULL"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 585,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 587,
                                            "length": 9,
                                            "snippet": "exit(-1);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 587,
                                                    "length": 8,
                                                    "snippet": "exit(-1)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "exit",
                                                            "pos": 587,
                                                            "length": 4,
                                                            "snippet": "exit"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 591,
                                                            "length": 4,
                                                            "snippet": "(-1)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 591,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "-1",
                                                                    "pos": 592,
                                                                    "length": 2,
                                                                    "snippet": "-1"
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 594,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 595,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 601,
                                    "length": 25,
                                    "snippet": "globalStruct->val = sock;",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 601,
                                            "length": 24,
                                            "snippet": "globalStruct->val = sock",
                                            "children": [
                                                {
                                                    "type": "field_expression",
                                                    "label": "",
                                                    "pos": 601,
                                                    "length": 17,
                                                    "snippet": "globalStruct->val",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 601,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "->",
                                                            "label": "->",
                                                            "pos": 613,
                                                            "length": 2,
                                                            "snippet": "->"
                                                        },
                                                        {
                                                            "type": "field_identifier",
                                                            "label": "val",
                                                            "pos": 615,
                                                            "length": 3,
                                                            "snippet": "val"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 619,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "sock",
                                                    "pos": 621,
                                                    "length": 4,
                                                    "snippet": "sock"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 625,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 631,
                                    "length": 27,
                                    "snippet": "signal(SIGTERM, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 631,
                                            "length": 27,
                                            "snippet": "signal(SIGTERM, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 631,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 637,
                                                    "length": 21,
                                                    "snippet": "(SIGTERM, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 637,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGTERM",
                                                            "pos": 638,
                                                            "length": 7,
                                                            "snippet": "SIGTERM"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 645,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 647,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 647,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 648,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 649,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 650,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 654,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 657,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 658,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 659,
                                    "length": 65,
                                    "snippet": "{\n        if (globalStruct != NULL) globalStruct->val = -1;\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 659,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 669,
                                            "length": 49,
                                            "snippet": "if (globalStruct != NULL) globalStruct->val = -1;",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 669,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 672,
                                                    "length": 22,
                                                    "snippet": "(globalStruct != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 672,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 673,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 673,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 686,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 689,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 689,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 693,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 695,
                                                    "length": 23,
                                                    "snippet": "globalStruct->val = -1;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 695,
                                                            "length": 22,
                                                            "snippet": "globalStruct->val = -1",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 695,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 695,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 707,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 709,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 713,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "-1",
                                                                    "pos": 715,
                                                                    "length": 2,
                                                                    "snippet": "-1"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 717,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 723,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 724,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 724,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 725,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 725,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "comment",
                                    "label": "// Pretend to do some network operations here",
                                    "pos": 731,
                                    "length": 45,
                                    "snippet": "// Pretend to do some network operations here"
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 781,
                                    "length": 162,
                                    "snippet": "if (globalStruct->val != -1) {  // Might be changed in the middle\n        close(globalStruct->val);\n        free(globalStruct);\n        globalStruct = NULL;\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 781,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 784,
                                            "length": 25,
                                            "snippet": "(globalStruct->val != -1)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 784,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 785,
                                                    "length": 23,
                                                    "snippet": "globalStruct->val != -1",
                                                    "children": [
                                                        {
                                                            "type": "field_expression",
                                                            "label": "",
                                                            "pos": 785,
                                                            "length": 17,
                                                            "snippet": "globalStruct->val",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 785,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "->",
                                                                    "label": "->",
                                                                    "pos": 797,
                                                                    "length": 2,
                                                                    "snippet": "->"
                                                                },
                                                                {
                                                                    "type": "field_identifier",
                                                                    "label": "val",
                                                                    "pos": 799,
                                                                    "length": 3,
                                                                    "snippet": "val"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "!=",
                                                            "label": "!=",
                                                            "pos": 803,
                                                            "length": 2,
                                                            "snippet": "!="
                                                        },
                                                        {
                                                            "type": "number_literal",
                                                            "label": "-1",
                                                            "pos": 806,
                                                            "length": 2,
                                                            "snippet": "-1"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 808,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 810,
                                            "length": 133,
                                            "snippet": "{  // Might be changed in the middle\n        close(globalStruct->val);\n        free(globalStruct);\n        globalStruct = NULL;\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 810,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "// Might be changed in the middle",
                                                    "pos": 813,
                                                    "length": 33,
                                                    "snippet": "// Might be changed in the middle"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 855,
                                                    "length": 25,
                                                    "snippet": "close(globalStruct->val);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 855,
                                                            "length": 24,
                                                            "snippet": "close(globalStruct->val)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "close",
                                                                    "pos": 855,
                                                                    "length": 5,
                                                                    "snippet": "close"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 860,
                                                                    "length": 19,
                                                                    "snippet": "(globalStruct->val)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 860,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "field_expression",
                                                                            "label": "",
                                                                            "pos": 861,
                                                                            "length": 17,
                                                                            "snippet": "globalStruct->val",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "globalStruct",
                                                                                    "pos": 861,
                                                                                    "length": 12,
                                                                                    "snippet": "globalStruct"
                                                                                },
                                                                                {
                                                                                    "type": "->",
                                                                                    "label": "->",
                                                                                    "pos": 873,
                                                                                    "length": 2,
                                                                                    "snippet": "->"
                                                                                },
                                                                                {
                                                                                    "type": "field_identifier",
                                                                                    "label": "val",
                                                                                    "pos": 875,
                                                                                    "length": 3,
                                                                                    "snippet": "val"
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 878,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 879,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 889,
                                                    "length": 19,
                                                    "snippet": "free(globalStruct);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 889,
                                                            "length": 18,
                                                            "snippet": "free(globalStruct)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "free",
                                                                    "pos": 889,
                                                                    "length": 4,
                                                                    "snippet": "free"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 893,
                                                                    "length": 14,
                                                                    "snippet": "(globalStruct)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 893,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 894,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 906,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 907,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 917,
                                                    "length": 20,
                                                    "snippet": "globalStruct = NULL;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 917,
                                                            "length": 19,
                                                            "snippet": "globalStruct = NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 917,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 930,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 932,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 932,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 936,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 942,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 944,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// GOOD - Uses signal-safe variables and checks in network ops",
                    "pos": 947,
                    "length": 62,
                    "snippet": "// GOOD - Uses signal-safe variables and checks in network ops"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 1010,
                    "length": 734,
                    "snippet": "void safe_network_op(void) {\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = sock;\n    signal(SIGTERM, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = -1;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_unlock(&lock);\n    // Pretend to do some network operations here\n    pthread_mutex_lock(&lock);\n    if (globalStruct->val != -1) {\n        close(globalStruct->val);\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 1010,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 1015,
                            "length": 21,
                            "snippet": "safe_network_op(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "safe_network_op",
                                    "pos": 1015,
                                    "length": 15,
                                    "snippet": "safe_network_op"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 1030,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 1030,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 1031,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 1031,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 1035,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 1037,
                            "length": 707,
                            "snippet": "{\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));\n    if (globalStruct == NULL) exit(-1);\n    globalStruct->val = sock;\n    signal(SIGTERM, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = -1;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_unlock(&lock);\n    // Pretend to do some network operations here\n    pthread_mutex_lock(&lock);\n    if (globalStruct->val != -1) {\n        close(globalStruct->val);\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 1037,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "declaration",
                                    "label": "",
                                    "pos": 1043,
                                    "length": 43,
                                    "snippet": "int sock = socket(AF_INET, SOCK_STREAM, 0);",
                                    "children": [
                                        {
                                            "type": "primitive_type",
                                            "label": "int",
                                            "pos": 1043,
                                            "length": 3,
                                            "snippet": "int"
                                        },
                                        {
                                            "type": "init_declarator",
                                            "label": "",
                                            "pos": 1047,
                                            "length": 38,
                                            "snippet": "sock = socket(AF_INET, SOCK_STREAM, 0)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "sock",
                                                    "pos": 1047,
                                                    "length": 4,
                                                    "snippet": "sock"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 1052,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1054,
                                                    "length": 31,
                                                    "snippet": "socket(AF_INET, SOCK_STREAM, 0)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "socket",
                                                            "pos": 1054,
                                                            "length": 6,
                                                            "snippet": "socket"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1060,
                                                            "length": 25,
                                                            "snippet": "(AF_INET, SOCK_STREAM, 0)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1060,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "AF_INET",
                                                                    "pos": 1061,
                                                                    "length": 7,
                                                                    "snippet": "AF_INET"
                                                                },
                                                                {
                                                                    "type": ",",
                                                                    "label": ",",
                                                                    "pos": 1068,
                                                                    "length": 1,
                                                                    "snippet": ","
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "SOCK_STREAM",
                                                                    "pos": 1070,
                                                                    "length": 11,
                                                                    "snippet": "SOCK_STREAM"
                                                                },
                                                                {
                                                                    "type": ",",
                                                                    "label": ",",
                                                                    "pos": 1081,
                                                                    "length": 1,
                                                                    "snippet": ","
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "0",
                                                                    "pos": 1083,
                                                                    "length": 1,
                                                                    "snippet": "0"
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1084,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1085,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1091,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1091,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 1091,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1109,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1109,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1110,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1110,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1111,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1115,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1116,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1122,
                                    "length": 65,
                                    "snippet": "globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic));",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 1122,
                                            "length": 64,
                                            "snippet": "globalStruct = (structSigAtomic*)malloc(sizeof(structSigAtomic))",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "globalStruct",
                                                    "pos": 1122,
                                                    "length": 12,
                                                    "snippet": "globalStruct"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 1135,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 1137,
                                                    "length": 49,
                                                    "snippet": "(structSigAtomic*)malloc(sizeof(structSigAtomic))",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1137,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 1138,
                                                            "length": 16,
                                                            "snippet": "structSigAtomic*",
                                                            "children": [
                                                                {
                                                                    "type": "type_identifier",
                                                                    "label": "structSigAtomic",
                                                                    "pos": 1138,
                                                                    "length": 15,
                                                                    "snippet": "structSigAtomic"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 1153,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 1153,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1154,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1155,
                                                            "length": 31,
                                                            "snippet": "malloc(sizeof(structSigAtomic))",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 1155,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1161,
                                                                    "length": 25,
                                                                    "snippet": "(sizeof(structSigAtomic))",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1161,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "sizeof_expression",
                                                                            "label": "",
                                                                            "pos": 1162,
                                                                            "length": 23,
                                                                            "snippet": "sizeof(structSigAtomic)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "sizeof",
                                                                                    "label": "sizeof",
                                                                                    "pos": 1162,
                                                                                    "length": 6,
                                                                                    "snippet": "sizeof"
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "",
                                                                                    "pos": 1168,
                                                                                    "length": 17,
                                                                                    "snippet": "(structSigAtomic)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 1168,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "structSigAtomic",
                                                                                            "pos": 1169,
                                                                                            "length": 15,
                                                                                            "snippet": "structSigAtomic"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 1184,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1185,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1186,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 1192,
                                    "length": 35,
                                    "snippet": "if (globalStruct == NULL) exit(-1);",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 1192,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 1195,
                                            "length": 22,
                                            "snippet": "(globalStruct == NULL)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 1195,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 1196,
                                                    "length": 20,
                                                    "snippet": "globalStruct == NULL",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 1196,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "==",
                                                            "label": "==",
                                                            "pos": 1209,
                                                            "length": 2,
                                                            "snippet": "=="
                                                        },
                                                        {
                                                            "type": "null",
                                                            "label": "",
                                                            "pos": 1212,
                                                            "length": 4,
                                                            "snippet": "NULL",
                                                            "children": [
                                                                {
                                                                    "type": "NULL",
                                                                    "label": "NULL",
                                                                    "pos": 1212,
                                                                    "length": 4,
                                                                    "snippet": "NULL"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 1216,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1218,
                                            "length": 9,
                                            "snippet": "exit(-1);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1218,
                                                    "length": 8,
                                                    "snippet": "exit(-1)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "exit",
                                                            "pos": 1218,
                                                            "length": 4,
                                                            "snippet": "exit"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1222,
                                                            "length": 4,
                                                            "snippet": "(-1)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1222,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "-1",
                                                                    "pos": 1223,
                                                                    "length": 2,
                                                                    "snippet": "-1"
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1225,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1226,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1232,
                                    "length": 25,
                                    "snippet": "globalStruct->val = sock;",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 1232,
                                            "length": 24,
                                            "snippet": "globalStruct->val = sock",
                                            "children": [
                                                {
                                                    "type": "field_expression",
                                                    "label": "",
                                                    "pos": 1232,
                                                    "length": 17,
                                                    "snippet": "globalStruct->val",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 1232,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "->",
                                                            "label": "->",
                                                            "pos": 1244,
                                                            "length": 2,
                                                            "snippet": "->"
                                                        },
                                                        {
                                                            "type": "field_identifier",
                                                            "label": "val",
                                                            "pos": 1246,
                                                            "length": 3,
                                                            "snippet": "val"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 1250,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "sock",
                                                    "pos": 1252,
                                                    "length": 4,
                                                    "snippet": "sock"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1256,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1262,
                                    "length": 27,
                                    "snippet": "signal(SIGTERM, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1262,
                                            "length": 27,
                                            "snippet": "signal(SIGTERM, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 1262,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1268,
                                                    "length": 21,
                                                    "snippet": "(SIGTERM, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1268,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGTERM",
                                                            "pos": 1269,
                                                            "length": 7,
                                                            "snippet": "SIGTERM"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 1276,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 1278,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 1278,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 1279,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1280,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 1281,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 1285,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1288,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 1289,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 1290,
                                    "length": 137,
                                    "snippet": "{\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = -1;\n        pthread_mutex_unlock(&lock);\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 1290,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1300,
                                            "length": 26,
                                            "snippet": "pthread_mutex_lock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1300,
                                                    "length": 25,
                                                    "snippet": "pthread_mutex_lock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_lock",
                                                            "pos": 1300,
                                                            "length": 18,
                                                            "snippet": "pthread_mutex_lock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1318,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1318,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1319,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1319,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1320,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1324,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1325,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 1335,
                                            "length": 49,
                                            "snippet": "if (globalStruct != NULL) globalStruct->val = -1;",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 1335,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 1338,
                                                    "length": 22,
                                                    "snippet": "(globalStruct != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1338,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 1339,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1339,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 1352,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1355,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1355,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1359,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1361,
                                                    "length": 23,
                                                    "snippet": "globalStruct->val = -1;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1361,
                                                            "length": 22,
                                                            "snippet": "globalStruct->val = -1",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 1361,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1361,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 1373,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 1375,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1379,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "-1",
                                                                    "pos": 1381,
                                                                    "length": 2,
                                                                    "snippet": "-1"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1383,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1393,
                                            "length": 28,
                                            "snippet": "pthread_mutex_unlock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1393,
                                                    "length": 27,
                                                    "snippet": "pthread_mutex_unlock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_unlock",
                                                            "pos": 1393,
                                                            "length": 20,
                                                            "snippet": "pthread_mutex_unlock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1413,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1413,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1414,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1414,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1415,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1419,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1420,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 1426,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 1427,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 1427,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1428,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1428,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1434,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1434,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 1434,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1454,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1454,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1455,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1455,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1456,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1460,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1461,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "comment",
                                    "label": "// Pretend to do some network operations here",
                                    "pos": 1467,
                                    "length": 45,
                                    "snippet": "// Pretend to do some network operations here"
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1517,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1517,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 1517,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1535,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1535,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1536,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1536,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1537,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1541,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1542,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 1548,
                                    "length": 161,
                                    "snippet": "if (globalStruct->val != -1) {\n        close(globalStruct->val);\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 1548,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 1551,
                                            "length": 25,
                                            "snippet": "(globalStruct->val != -1)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 1551,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 1552,
                                                    "length": 23,
                                                    "snippet": "globalStruct->val != -1",
                                                    "children": [
                                                        {
                                                            "type": "field_expression",
                                                            "label": "",
                                                            "pos": 1552,
                                                            "length": 17,
                                                            "snippet": "globalStruct->val",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1552,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "->",
                                                                    "label": "->",
                                                                    "pos": 1564,
                                                                    "length": 2,
                                                                    "snippet": "->"
                                                                },
                                                                {
                                                                    "type": "field_identifier",
                                                                    "label": "val",
                                                                    "pos": 1566,
                                                                    "length": 3,
                                                                    "snippet": "val"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "!=",
                                                            "label": "!=",
                                                            "pos": 1570,
                                                            "length": 2,
                                                            "snippet": "!="
                                                        },
                                                        {
                                                            "type": "number_literal",
                                                            "label": "-1",
                                                            "pos": 1573,
                                                            "length": 2,
                                                            "snippet": "-1"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 1575,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 1577,
                                            "length": 132,
                                            "snippet": "{\n        close(globalStruct->val);\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 1577,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1587,
                                                    "length": 25,
                                                    "snippet": "close(globalStruct->val);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1587,
                                                            "length": 24,
                                                            "snippet": "close(globalStruct->val)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "close",
                                                                    "pos": 1587,
                                                                    "length": 5,
                                                                    "snippet": "close"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1592,
                                                                    "length": 19,
                                                                    "snippet": "(globalStruct->val)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1592,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "field_expression",
                                                                            "label": "",
                                                                            "pos": 1593,
                                                                            "length": 17,
                                                                            "snippet": "globalStruct->val",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "globalStruct",
                                                                                    "pos": 1593,
                                                                                    "length": 12,
                                                                                    "snippet": "globalStruct"
                                                                                },
                                                                                {
                                                                                    "type": "->",
                                                                                    "label": "->",
                                                                                    "pos": 1605,
                                                                                    "length": 2,
                                                                                    "snippet": "->"
                                                                                },
                                                                                {
                                                                                    "type": "field_identifier",
                                                                                    "label": "val",
                                                                                    "pos": 1607,
                                                                                    "length": 3,
                                                                                    "snippet": "val"
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1610,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1611,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1621,
                                                    "length": 19,
                                                    "snippet": "free(globalStruct);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1621,
                                                            "length": 18,
                                                            "snippet": "free(globalStruct)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "free",
                                                                    "pos": 1621,
                                                                    "length": 4,
                                                                    "snippet": "free"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1625,
                                                                    "length": 14,
                                                                    "snippet": "(globalStruct)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1625,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1626,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1638,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1639,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "// Freed within a locked section",
                                                    "pos": 1642,
                                                    "length": 32,
                                                    "snippet": "// Freed within a locked section"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1683,
                                                    "length": 20,
                                                    "snippet": "globalStruct = NULL;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1683,
                                                            "length": 19,
                                                            "snippet": "globalStruct = NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1683,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1696,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1698,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1698,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1702,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 1708,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1714,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1714,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 1714,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1734,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1734,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1735,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1735,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1736,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1740,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1741,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 1743,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    {
        "file_path": "gpt-generated/CWE364_Signal_Handler_Race_Condition/CWE364_gpt_generated_part3.c",
        "source": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Unsafe handling in user input processing\nvoid vulnerable_user_input(void) {\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    scanf(\"%d\", &globalStruct->val);\n    signal(SIGALRM, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 42;\n    });\n    if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);\n        globalStruct = NULL;\n    }\n}\n\n// GOOD - Secure handling of user inputs\nvoid safe_user_input(void) {\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    pthread_mutex_unlock(&lock);\n    scanf(\"%d\", &globalStruct->val);\n    signal(SIGALRM, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 42;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_lock(&lock);\n    if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}\n",
        "ast": {
            "type": "translation_unit",
            "label": "",
            "pos": 0,
            "length": 1391,
            "snippet": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Unsafe handling in user input processing\nvoid vulnerable_user_input(void) {\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    scanf(\"%d\", &globalStruct->val);\n    signal(SIGALRM, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 42;\n    });\n    if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);\n        globalStruct = NULL;\n    }\n}\n\n// GOOD - Secure handling of user inputs\nvoid safe_user_input(void) {\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    pthread_mutex_unlock(&lock);\n    scanf(\"%d\", &globalStruct->val);\n    signal(SIGALRM, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 42;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_lock(&lock);\n    if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
            "children": [
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 0,
                    "length": 19,
                    "snippet": "#include <stdio.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 0,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdio.h>",
                            "pos": 9,
                            "length": 9,
                            "snippet": "<stdio.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 19,
                    "length": 20,
                    "snippet": "#include <stdlib.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 19,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdlib.h>",
                            "pos": 28,
                            "length": 10,
                            "snippet": "<stdlib.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 39,
                    "length": 20,
                    "snippet": "#include <signal.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 39,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<signal.h>",
                            "pos": 48,
                            "length": 10,
                            "snippet": "<signal.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 59,
                    "length": 20,
                    "snippet": "#include <unistd.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 59,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<unistd.h>",
                            "pos": 68,
                            "length": 10,
                            "snippet": "<unistd.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 79,
                    "length": 21,
                    "snippet": "#include <pthread.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 79,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<pthread.h>",
                            "pos": 88,
                            "length": 11,
                            "snippet": "<pthread.h>"
                        }
                    ]
                },
                {
                    "type": "type_definition",
                    "label": "",
                    "pos": 101,
                    "length": 48,
                    "snippet": "typedef struct {\n    int val;\n} structSigAtomic;",
                    "children": [
                        {
                            "type": "typedef",
                            "label": "typedef",
                            "pos": 101,
                            "length": 7,
                            "snippet": "typedef"
                        },
                        {
                            "type": "struct_specifier",
                            "label": "",
                            "pos": 109,
                            "length": 23,
                            "snippet": "struct {\n    int val;\n}",
                            "children": [
                                {
                                    "type": "struct",
                                    "label": "struct",
                                    "pos": 109,
                                    "length": 6,
                                    "snippet": "struct"
                                },
                                {
                                    "type": "field_declaration_list",
                                    "label": "",
                                    "pos": 116,
                                    "length": 16,
                                    "snippet": "{\n    int val;\n}",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 116,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "field_declaration",
                                            "label": "",
                                            "pos": 122,
                                            "length": 8,
                                            "snippet": "int val;",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "int",
                                                    "pos": 122,
                                                    "length": 3,
                                                    "snippet": "int"
                                                },
                                                {
                                                    "type": "field_identifier",
                                                    "label": "val",
                                                    "pos": 126,
                                                    "length": 3,
                                                    "snippet": "val"
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 129,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 131,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 133,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 148,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// Global variables used across multiple functions",
                    "pos": 151,
                    "length": 50,
                    "snippet": "// Global variables used across multiple functions"
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 202,
                    "length": 37,
                    "snippet": "volatile sig_atomic_t signalFlag = 0;",
                    "children": [
                        {
                            "type": "type_qualifier",
                            "label": "",
                            "pos": 202,
                            "length": 8,
                            "snippet": "volatile",
                            "children": [
                                {
                                    "type": "volatile",
                                    "label": "volatile",
                                    "pos": 202,
                                    "length": 8,
                                    "snippet": "volatile"
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "sig_atomic_t",
                            "pos": 211,
                            "length": 12,
                            "snippet": "sig_atomic_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 224,
                            "length": 14,
                            "snippet": "signalFlag = 0",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "signalFlag",
                                    "pos": 224,
                                    "length": 10,
                                    "snippet": "signalFlag"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 235,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "number_literal",
                                    "label": "0",
                                    "pos": 237,
                                    "length": 1,
                                    "snippet": "0"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 238,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 240,
                    "length": 37,
                    "snippet": "structSigAtomic *globalStruct = NULL;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 240,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 256,
                            "length": 20,
                            "snippet": "*globalStruct = NULL",
                            "children": [
                                {
                                    "type": "pointer_declarator",
                                    "label": "",
                                    "pos": 256,
                                    "length": 13,
                                    "snippet": "*globalStruct",
                                    "children": [
                                        {
                                            "type": "*",
                                            "label": "*",
                                            "pos": 256,
                                            "length": 1,
                                            "snippet": "*"
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "globalStruct",
                                            "pos": 257,
                                            "length": 12,
                                            "snippet": "globalStruct"
                                        }
                                    ]
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 270,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "null",
                                    "label": "",
                                    "pos": 272,
                                    "length": 4,
                                    "snippet": "NULL",
                                    "children": [
                                        {
                                            "type": "NULL",
                                            "label": "NULL",
                                            "pos": 272,
                                            "length": 4,
                                            "snippet": "NULL"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 276,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 278,
                    "length": 49,
                    "snippet": "pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "pthread_mutex_t",
                            "pos": 278,
                            "length": 15,
                            "snippet": "pthread_mutex_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 294,
                            "length": 32,
                            "snippet": "lock = PTHREAD_MUTEX_INITIALIZER",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "lock",
                                    "pos": 294,
                                    "length": 4,
                                    "snippet": "lock"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 299,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "identifier",
                                    "label": "PTHREAD_MUTEX_INITIALIZER",
                                    "pos": 301,
                                    "length": 25,
                                    "snippet": "PTHREAD_MUTEX_INITIALIZER"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 326,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// BAD - CWE-364: Unsafe handling in user input processing",
                    "pos": 329,
                    "length": 58,
                    "snippet": "// BAD - CWE-364: Unsafe handling in user input processing"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 388,
                    "length": 366,
                    "snippet": "void vulnerable_user_input(void) {\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    scanf(\"%d\", &globalStruct->val);\n    signal(SIGALRM, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 42;\n    });\n    if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);\n        globalStruct = NULL;\n    }\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 388,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 393,
                            "length": 27,
                            "snippet": "vulnerable_user_input(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "vulnerable_user_input",
                                    "pos": 393,
                                    "length": 21,
                                    "snippet": "vulnerable_user_input"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 414,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 414,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 415,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 415,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 419,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 421,
                            "length": 333,
                            "snippet": "{\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    scanf(\"%d\", &globalStruct->val);\n    signal(SIGALRM, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 42;\n    });\n    if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);\n        globalStruct = NULL;\n    }\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 421,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 427,
                                    "length": 66,
                                    "snippet": "globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 427,
                                            "length": 65,
                                            "snippet": "globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic))",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "globalStruct",
                                                    "pos": 427,
                                                    "length": 12,
                                                    "snippet": "globalStruct"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 440,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 442,
                                                    "length": 50,
                                                    "snippet": "(structSigAtomic *)malloc(sizeof(structSigAtomic))",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 442,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 443,
                                                            "length": 17,
                                                            "snippet": "structSigAtomic *",
                                                            "children": [
                                                                {
                                                                    "type": "type_identifier",
                                                                    "label": "structSigAtomic",
                                                                    "pos": 443,
                                                                    "length": 15,
                                                                    "snippet": "structSigAtomic"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 459,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 459,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 460,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 461,
                                                            "length": 31,
                                                            "snippet": "malloc(sizeof(structSigAtomic))",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 461,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 467,
                                                                    "length": 25,
                                                                    "snippet": "(sizeof(structSigAtomic))",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 467,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "sizeof_expression",
                                                                            "label": "",
                                                                            "pos": 468,
                                                                            "length": 23,
                                                                            "snippet": "sizeof(structSigAtomic)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "sizeof",
                                                                                    "label": "sizeof",
                                                                                    "pos": 468,
                                                                                    "length": 6,
                                                                                    "snippet": "sizeof"
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "",
                                                                                    "pos": 474,
                                                                                    "length": 17,
                                                                                    "snippet": "(structSigAtomic)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 474,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "structSigAtomic",
                                                                                            "pos": 475,
                                                                                            "length": 15,
                                                                                            "snippet": "structSigAtomic"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 490,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 491,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 492,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 498,
                                    "length": 32,
                                    "snippet": "scanf(\"%d\", &globalStruct->val);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 498,
                                            "length": 31,
                                            "snippet": "scanf(\"%d\", &globalStruct->val)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "scanf",
                                                    "pos": 498,
                                                    "length": 5,
                                                    "snippet": "scanf"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 503,
                                                    "length": 26,
                                                    "snippet": "(\"%d\", &globalStruct->val)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 503,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "string_literal",
                                                            "label": "",
                                                            "pos": 504,
                                                            "length": 4,
                                                            "snippet": "\"%d\"",
                                                            "children": [
                                                                {
                                                                    "type": "\"",
                                                                    "label": "\"",
                                                                    "pos": 504,
                                                                    "length": 1,
                                                                    "snippet": "\""
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "%d",
                                                                    "pos": 505,
                                                                    "length": 2,
                                                                    "snippet": "%d"
                                                                },
                                                                {
                                                                    "type": "\"",
                                                                    "label": "\"",
                                                                    "pos": 507,
                                                                    "length": 1,
                                                                    "snippet": "\""
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 508,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 510,
                                                            "length": 18,
                                                            "snippet": "&globalStruct->val",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 510,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 511,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 511,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 523,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 525,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 528,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 529,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 535,
                                    "length": 27,
                                    "snippet": "signal(SIGALRM, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 535,
                                            "length": 27,
                                            "snippet": "signal(SIGALRM, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 535,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 541,
                                                    "length": 21,
                                                    "snippet": "(SIGALRM, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 541,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGALRM",
                                                            "pos": 542,
                                                            "length": 7,
                                                            "snippet": "SIGALRM"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 549,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 551,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 551,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 552,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 553,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 554,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 558,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 561,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 562,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 563,
                                    "length": 65,
                                    "snippet": "{\n        if (globalStruct != NULL) globalStruct->val = 42;\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 563,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 573,
                                            "length": 49,
                                            "snippet": "if (globalStruct != NULL) globalStruct->val = 42;",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 573,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 576,
                                                    "length": 22,
                                                    "snippet": "(globalStruct != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 576,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 577,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 577,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 590,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 593,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 593,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 597,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 599,
                                                    "length": 23,
                                                    "snippet": "globalStruct->val = 42;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 599,
                                                            "length": 22,
                                                            "snippet": "globalStruct->val = 42",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 599,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 599,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 611,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 613,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 617,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "42",
                                                                    "pos": 619,
                                                                    "length": 2,
                                                                    "snippet": "42"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 621,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 627,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 628,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 628,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 629,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 629,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 635,
                                    "length": 117,
                                    "snippet": "if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);\n        globalStruct = NULL;\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 635,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 638,
                                            "length": 49,
                                            "snippet": "(globalStruct != NULL && globalStruct->val != 42)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 638,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 639,
                                                    "length": 47,
                                                    "snippet": "globalStruct != NULL && globalStruct->val != 42",
                                                    "children": [
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 639,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 639,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 652,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 655,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 655,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "&&",
                                                            "label": "&&",
                                                            "pos": 660,
                                                            "length": 2,
                                                            "snippet": "&&"
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 663,
                                                            "length": 23,
                                                            "snippet": "globalStruct->val != 42",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 663,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 663,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 675,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 677,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 681,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "42",
                                                                    "pos": 684,
                                                                    "length": 2,
                                                                    "snippet": "42"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 686,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 688,
                                            "length": 64,
                                            "snippet": "{\n        free(globalStruct);\n        globalStruct = NULL;\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 688,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 698,
                                                    "length": 19,
                                                    "snippet": "free(globalStruct);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 698,
                                                            "length": 18,
                                                            "snippet": "free(globalStruct)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "free",
                                                                    "pos": 698,
                                                                    "length": 4,
                                                                    "snippet": "free"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 702,
                                                                    "length": 14,
                                                                    "snippet": "(globalStruct)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 702,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 703,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 715,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 716,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 726,
                                                    "length": 20,
                                                    "snippet": "globalStruct = NULL;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 726,
                                                            "length": 19,
                                                            "snippet": "globalStruct = NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 726,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 739,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 741,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 741,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 745,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 751,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 753,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// GOOD - Secure handling of user inputs",
                    "pos": 756,
                    "length": 40,
                    "snippet": "// GOOD - Secure handling of user inputs"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 797,
                    "length": 594,
                    "snippet": "void safe_user_input(void) {\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    pthread_mutex_unlock(&lock);\n    scanf(\"%d\", &globalStruct->val);\n    signal(SIGALRM, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 42;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_lock(&lock);\n    if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 797,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 802,
                            "length": 21,
                            "snippet": "safe_user_input(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "safe_user_input",
                                    "pos": 802,
                                    "length": 15,
                                    "snippet": "safe_user_input"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 817,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 817,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 818,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 818,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 822,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 824,
                            "length": 567,
                            "snippet": "{\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    pthread_mutex_unlock(&lock);\n    scanf(\"%d\", &globalStruct->val);\n    signal(SIGALRM, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 42;\n        pthread_mutex_unlock(&lock);\n    });\n    pthread_mutex_lock(&lock);\n    if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 824,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 830,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 830,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 830,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 848,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 848,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 849,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 849,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 850,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 854,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 855,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 861,
                                    "length": 66,
                                    "snippet": "globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 861,
                                            "length": 65,
                                            "snippet": "globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic))",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "globalStruct",
                                                    "pos": 861,
                                                    "length": 12,
                                                    "snippet": "globalStruct"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 874,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 876,
                                                    "length": 50,
                                                    "snippet": "(structSigAtomic *)malloc(sizeof(structSigAtomic))",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 876,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 877,
                                                            "length": 17,
                                                            "snippet": "structSigAtomic *",
                                                            "children": [
                                                                {
                                                                    "type": "type_identifier",
                                                                    "label": "structSigAtomic",
                                                                    "pos": 877,
                                                                    "length": 15,
                                                                    "snippet": "structSigAtomic"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 893,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 893,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 894,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 895,
                                                            "length": 31,
                                                            "snippet": "malloc(sizeof(structSigAtomic))",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 895,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 901,
                                                                    "length": 25,
                                                                    "snippet": "(sizeof(structSigAtomic))",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 901,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "sizeof_expression",
                                                                            "label": "",
                                                                            "pos": 902,
                                                                            "length": 23,
                                                                            "snippet": "sizeof(structSigAtomic)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "sizeof",
                                                                                    "label": "sizeof",
                                                                                    "pos": 902,
                                                                                    "length": 6,
                                                                                    "snippet": "sizeof"
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "",
                                                                                    "pos": 908,
                                                                                    "length": 17,
                                                                                    "snippet": "(structSigAtomic)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 908,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "structSigAtomic",
                                                                                            "pos": 909,
                                                                                            "length": 15,
                                                                                            "snippet": "structSigAtomic"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 924,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 925,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 926,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 932,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 932,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 932,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 952,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 952,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 953,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 953,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 954,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 958,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 959,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 965,
                                    "length": 32,
                                    "snippet": "scanf(\"%d\", &globalStruct->val);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 965,
                                            "length": 31,
                                            "snippet": "scanf(\"%d\", &globalStruct->val)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "scanf",
                                                    "pos": 965,
                                                    "length": 5,
                                                    "snippet": "scanf"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 970,
                                                    "length": 26,
                                                    "snippet": "(\"%d\", &globalStruct->val)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 970,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "string_literal",
                                                            "label": "",
                                                            "pos": 971,
                                                            "length": 4,
                                                            "snippet": "\"%d\"",
                                                            "children": [
                                                                {
                                                                    "type": "\"",
                                                                    "label": "\"",
                                                                    "pos": 971,
                                                                    "length": 1,
                                                                    "snippet": "\""
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "%d",
                                                                    "pos": 972,
                                                                    "length": 2,
                                                                    "snippet": "%d"
                                                                },
                                                                {
                                                                    "type": "\"",
                                                                    "label": "\"",
                                                                    "pos": 974,
                                                                    "length": 1,
                                                                    "snippet": "\""
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 975,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 977,
                                                            "length": 18,
                                                            "snippet": "&globalStruct->val",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 977,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 978,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 978,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 990,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 992,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 995,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 996,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1002,
                                    "length": 27,
                                    "snippet": "signal(SIGALRM, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1002,
                                            "length": 27,
                                            "snippet": "signal(SIGALRM, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 1002,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1008,
                                                    "length": 21,
                                                    "snippet": "(SIGALRM, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1008,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGALRM",
                                                            "pos": 1009,
                                                            "length": 7,
                                                            "snippet": "SIGALRM"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 1016,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 1018,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 1018,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 1019,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1020,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 1021,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 1025,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1028,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 1029,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 1030,
                                    "length": 137,
                                    "snippet": "{\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 42;\n        pthread_mutex_unlock(&lock);\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 1030,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1040,
                                            "length": 26,
                                            "snippet": "pthread_mutex_lock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1040,
                                                    "length": 25,
                                                    "snippet": "pthread_mutex_lock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_lock",
                                                            "pos": 1040,
                                                            "length": 18,
                                                            "snippet": "pthread_mutex_lock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1058,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1058,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1059,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1059,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1060,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1064,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1065,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 1075,
                                            "length": 49,
                                            "snippet": "if (globalStruct != NULL) globalStruct->val = 42;",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 1075,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 1078,
                                                    "length": 22,
                                                    "snippet": "(globalStruct != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1078,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 1079,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1079,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 1092,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1095,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1095,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1099,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1101,
                                                    "length": 23,
                                                    "snippet": "globalStruct->val = 42;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1101,
                                                            "length": 22,
                                                            "snippet": "globalStruct->val = 42",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 1101,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1101,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 1113,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 1115,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1119,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "42",
                                                                    "pos": 1121,
                                                                    "length": 2,
                                                                    "snippet": "42"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1123,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1133,
                                            "length": 28,
                                            "snippet": "pthread_mutex_unlock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1133,
                                                    "length": 27,
                                                    "snippet": "pthread_mutex_unlock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_unlock",
                                                            "pos": 1133,
                                                            "length": 20,
                                                            "snippet": "pthread_mutex_unlock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1153,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1153,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1154,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1154,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1155,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1159,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1160,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 1166,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 1167,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 1167,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1168,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1168,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1174,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1174,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 1174,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1192,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1192,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1193,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1193,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1194,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1198,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1199,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 1205,
                                    "length": 151,
                                    "snippet": "if (globalStruct != NULL && globalStruct->val != 42) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 1205,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 1208,
                                            "length": 49,
                                            "snippet": "(globalStruct != NULL && globalStruct->val != 42)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 1208,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 1209,
                                                    "length": 47,
                                                    "snippet": "globalStruct != NULL && globalStruct->val != 42",
                                                    "children": [
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 1209,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1209,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 1222,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1225,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1225,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "&&",
                                                            "label": "&&",
                                                            "pos": 1230,
                                                            "length": 2,
                                                            "snippet": "&&"
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 1233,
                                                            "length": 23,
                                                            "snippet": "globalStruct->val != 42",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 1233,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1233,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 1245,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 1247,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 1251,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "42",
                                                                    "pos": 1254,
                                                                    "length": 2,
                                                                    "snippet": "42"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 1256,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 1258,
                                            "length": 98,
                                            "snippet": "{\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 1258,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1268,
                                                    "length": 19,
                                                    "snippet": "free(globalStruct);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1268,
                                                            "length": 18,
                                                            "snippet": "free(globalStruct)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "free",
                                                                    "pos": 1268,
                                                                    "length": 4,
                                                                    "snippet": "free"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1272,
                                                                    "length": 14,
                                                                    "snippet": "(globalStruct)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1272,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1273,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1285,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1286,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "// Freed within a locked section",
                                                    "pos": 1289,
                                                    "length": 32,
                                                    "snippet": "// Freed within a locked section"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1330,
                                                    "length": 20,
                                                    "snippet": "globalStruct = NULL;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1330,
                                                            "length": 19,
                                                            "snippet": "globalStruct = NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1330,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1343,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1345,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1345,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1349,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 1355,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1361,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1361,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 1361,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1381,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1381,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1382,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1382,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1383,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1387,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1388,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 1390,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    {
        "file_path": "gpt-generated/CWE364_Signal_Handler_Race_Condition/CWE364_gpt_generated_part4.c",
        "source": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Race condition with data structures\nvoid vulnerable_data_structures(void) {\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    signal(SIGUSR2, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 3;\n    });\n    \n    globalStruct->val = 5;\n    if (globalStruct != NULL) {\n        free(globalStruct);\n        globalStruct = NULL;  // Set to NULL might be interrupted\n    }\n}\n\n// GOOD - Proper handling with mutex for data structures\nvoid safe_data_structures(void) {\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    pthread_mutex_unlock(&lock);\n    signal(SIGUSR2, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 3;\n        pthread_mutex_unlock(&lock);\n    });\n    \n    pthread_mutex_lock(&lock);\n    globalStruct->val = 5;\n    if (globalStruct != NULL) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}\n",
        "ast": {
            "type": "translation_unit",
            "label": "",
            "pos": 0,
            "length": 1383,
            "snippet": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Race condition with data structures\nvoid vulnerable_data_structures(void) {\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    signal(SIGUSR2, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 3;\n    });\n    \n    globalStruct->val = 5;\n    if (globalStruct != NULL) {\n        free(globalStruct);\n        globalStruct = NULL;  // Set to NULL might be interrupted\n    }\n}\n\n// GOOD - Proper handling with mutex for data structures\nvoid safe_data_structures(void) {\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    pthread_mutex_unlock(&lock);\n    signal(SIGUSR2, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 3;\n        pthread_mutex_unlock(&lock);\n    });\n    \n    pthread_mutex_lock(&lock);\n    globalStruct->val = 5;\n    if (globalStruct != NULL) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
            "children": [
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 0,
                    "length": 19,
                    "snippet": "#include <stdio.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 0,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdio.h>",
                            "pos": 9,
                            "length": 9,
                            "snippet": "<stdio.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 19,
                    "length": 20,
                    "snippet": "#include <stdlib.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 19,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdlib.h>",
                            "pos": 28,
                            "length": 10,
                            "snippet": "<stdlib.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 39,
                    "length": 20,
                    "snippet": "#include <signal.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 39,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<signal.h>",
                            "pos": 48,
                            "length": 10,
                            "snippet": "<signal.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 59,
                    "length": 20,
                    "snippet": "#include <unistd.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 59,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<unistd.h>",
                            "pos": 68,
                            "length": 10,
                            "snippet": "<unistd.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 79,
                    "length": 21,
                    "snippet": "#include <pthread.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 79,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<pthread.h>",
                            "pos": 88,
                            "length": 11,
                            "snippet": "<pthread.h>"
                        }
                    ]
                },
                {
                    "type": "type_definition",
                    "label": "",
                    "pos": 101,
                    "length": 48,
                    "snippet": "typedef struct {\n    int val;\n} structSigAtomic;",
                    "children": [
                        {
                            "type": "typedef",
                            "label": "typedef",
                            "pos": 101,
                            "length": 7,
                            "snippet": "typedef"
                        },
                        {
                            "type": "struct_specifier",
                            "label": "",
                            "pos": 109,
                            "length": 23,
                            "snippet": "struct {\n    int val;\n}",
                            "children": [
                                {
                                    "type": "struct",
                                    "label": "struct",
                                    "pos": 109,
                                    "length": 6,
                                    "snippet": "struct"
                                },
                                {
                                    "type": "field_declaration_list",
                                    "label": "",
                                    "pos": 116,
                                    "length": 16,
                                    "snippet": "{\n    int val;\n}",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 116,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "field_declaration",
                                            "label": "",
                                            "pos": 122,
                                            "length": 8,
                                            "snippet": "int val;",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "int",
                                                    "pos": 122,
                                                    "length": 3,
                                                    "snippet": "int"
                                                },
                                                {
                                                    "type": "field_identifier",
                                                    "label": "val",
                                                    "pos": 126,
                                                    "length": 3,
                                                    "snippet": "val"
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 129,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 131,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 133,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 148,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// Global variables used across multiple functions",
                    "pos": 151,
                    "length": 50,
                    "snippet": "// Global variables used across multiple functions"
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 202,
                    "length": 37,
                    "snippet": "volatile sig_atomic_t signalFlag = 0;",
                    "children": [
                        {
                            "type": "type_qualifier",
                            "label": "",
                            "pos": 202,
                            "length": 8,
                            "snippet": "volatile",
                            "children": [
                                {
                                    "type": "volatile",
                                    "label": "volatile",
                                    "pos": 202,
                                    "length": 8,
                                    "snippet": "volatile"
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "sig_atomic_t",
                            "pos": 211,
                            "length": 12,
                            "snippet": "sig_atomic_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 224,
                            "length": 14,
                            "snippet": "signalFlag = 0",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "signalFlag",
                                    "pos": 224,
                                    "length": 10,
                                    "snippet": "signalFlag"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 235,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "number_literal",
                                    "label": "0",
                                    "pos": 237,
                                    "length": 1,
                                    "snippet": "0"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 238,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 240,
                    "length": 37,
                    "snippet": "structSigAtomic *globalStruct = NULL;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 240,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 256,
                            "length": 20,
                            "snippet": "*globalStruct = NULL",
                            "children": [
                                {
                                    "type": "pointer_declarator",
                                    "label": "",
                                    "pos": 256,
                                    "length": 13,
                                    "snippet": "*globalStruct",
                                    "children": [
                                        {
                                            "type": "*",
                                            "label": "*",
                                            "pos": 256,
                                            "length": 1,
                                            "snippet": "*"
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "globalStruct",
                                            "pos": 257,
                                            "length": 12,
                                            "snippet": "globalStruct"
                                        }
                                    ]
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 270,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "null",
                                    "label": "",
                                    "pos": 272,
                                    "length": 4,
                                    "snippet": "NULL",
                                    "children": [
                                        {
                                            "type": "NULL",
                                            "label": "NULL",
                                            "pos": 272,
                                            "length": 4,
                                            "snippet": "NULL"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 276,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 278,
                    "length": 49,
                    "snippet": "pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "pthread_mutex_t",
                            "pos": 278,
                            "length": 15,
                            "snippet": "pthread_mutex_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 294,
                            "length": 32,
                            "snippet": "lock = PTHREAD_MUTEX_INITIALIZER",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "lock",
                                    "pos": 294,
                                    "length": 4,
                                    "snippet": "lock"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 299,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "identifier",
                                    "label": "PTHREAD_MUTEX_INITIALIZER",
                                    "pos": 301,
                                    "length": 25,
                                    "snippet": "PTHREAD_MUTEX_INITIALIZER"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 326,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// BAD - CWE-364: Race condition with data structures",
                    "pos": 329,
                    "length": 53,
                    "snippet": "// BAD - CWE-364: Race condition with data structures"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 383,
                    "length": 375,
                    "snippet": "void vulnerable_data_structures(void) {\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    signal(SIGUSR2, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 3;\n    });\n    \n    globalStruct->val = 5;\n    if (globalStruct != NULL) {\n        free(globalStruct);\n        globalStruct = NULL;  // Set to NULL might be interrupted\n    }\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 383,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 388,
                            "length": 32,
                            "snippet": "vulnerable_data_structures(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "vulnerable_data_structures",
                                    "pos": 388,
                                    "length": 26,
                                    "snippet": "vulnerable_data_structures"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 414,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 414,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 415,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 415,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 419,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 421,
                            "length": 337,
                            "snippet": "{\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    signal(SIGUSR2, [](int sig) {\n        if (globalStruct != NULL) globalStruct->val = 3;\n    });\n    \n    globalStruct->val = 5;\n    if (globalStruct != NULL) {\n        free(globalStruct);\n        globalStruct = NULL;  // Set to NULL might be interrupted\n    }\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 421,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 427,
                                    "length": 66,
                                    "snippet": "globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 427,
                                            "length": 65,
                                            "snippet": "globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic))",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "globalStruct",
                                                    "pos": 427,
                                                    "length": 12,
                                                    "snippet": "globalStruct"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 440,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 442,
                                                    "length": 50,
                                                    "snippet": "(structSigAtomic *)malloc(sizeof(structSigAtomic))",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 442,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 443,
                                                            "length": 17,
                                                            "snippet": "structSigAtomic *",
                                                            "children": [
                                                                {
                                                                    "type": "type_identifier",
                                                                    "label": "structSigAtomic",
                                                                    "pos": 443,
                                                                    "length": 15,
                                                                    "snippet": "structSigAtomic"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 459,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 459,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 460,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 461,
                                                            "length": 31,
                                                            "snippet": "malloc(sizeof(structSigAtomic))",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 461,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 467,
                                                                    "length": 25,
                                                                    "snippet": "(sizeof(structSigAtomic))",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 467,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "sizeof_expression",
                                                                            "label": "",
                                                                            "pos": 468,
                                                                            "length": 23,
                                                                            "snippet": "sizeof(structSigAtomic)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "sizeof",
                                                                                    "label": "sizeof",
                                                                                    "pos": 468,
                                                                                    "length": 6,
                                                                                    "snippet": "sizeof"
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "",
                                                                                    "pos": 474,
                                                                                    "length": 17,
                                                                                    "snippet": "(structSigAtomic)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 474,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "structSigAtomic",
                                                                                            "pos": 475,
                                                                                            "length": 15,
                                                                                            "snippet": "structSigAtomic"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 490,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 491,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 492,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 498,
                                    "length": 27,
                                    "snippet": "signal(SIGUSR2, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 498,
                                            "length": 27,
                                            "snippet": "signal(SIGUSR2, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 498,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 504,
                                                    "length": 21,
                                                    "snippet": "(SIGUSR2, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 504,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGUSR2",
                                                            "pos": 505,
                                                            "length": 7,
                                                            "snippet": "SIGUSR2"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 512,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 514,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 514,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 515,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 516,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 517,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 521,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 524,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 525,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 526,
                                    "length": 64,
                                    "snippet": "{\n        if (globalStruct != NULL) globalStruct->val = 3;\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 526,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 536,
                                            "length": 48,
                                            "snippet": "if (globalStruct != NULL) globalStruct->val = 3;",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 536,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 539,
                                                    "length": 22,
                                                    "snippet": "(globalStruct != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 539,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 540,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 540,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 553,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 556,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 556,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 560,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 562,
                                                    "length": 22,
                                                    "snippet": "globalStruct->val = 3;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 562,
                                                            "length": 21,
                                                            "snippet": "globalStruct->val = 3",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 562,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 562,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 574,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 576,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 580,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "3",
                                                                    "pos": 582,
                                                                    "length": 1,
                                                                    "snippet": "3"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 583,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 589,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 590,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 590,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 591,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 591,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 602,
                                    "length": 22,
                                    "snippet": "globalStruct->val = 5;",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 602,
                                            "length": 21,
                                            "snippet": "globalStruct->val = 5",
                                            "children": [
                                                {
                                                    "type": "field_expression",
                                                    "label": "",
                                                    "pos": 602,
                                                    "length": 17,
                                                    "snippet": "globalStruct->val",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 602,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "->",
                                                            "label": "->",
                                                            "pos": 614,
                                                            "length": 2,
                                                            "snippet": "->"
                                                        },
                                                        {
                                                            "type": "field_identifier",
                                                            "label": "val",
                                                            "pos": 616,
                                                            "length": 3,
                                                            "snippet": "val"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 620,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "number_literal",
                                                    "label": "5",
                                                    "pos": 622,
                                                    "length": 1,
                                                    "snippet": "5"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 623,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 629,
                                    "length": 127,
                                    "snippet": "if (globalStruct != NULL) {\n        free(globalStruct);\n        globalStruct = NULL;  // Set to NULL might be interrupted\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 629,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 632,
                                            "length": 22,
                                            "snippet": "(globalStruct != NULL)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 632,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 633,
                                                    "length": 20,
                                                    "snippet": "globalStruct != NULL",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 633,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "!=",
                                                            "label": "!=",
                                                            "pos": 646,
                                                            "length": 2,
                                                            "snippet": "!="
                                                        },
                                                        {
                                                            "type": "null",
                                                            "label": "",
                                                            "pos": 649,
                                                            "length": 4,
                                                            "snippet": "NULL",
                                                            "children": [
                                                                {
                                                                    "type": "NULL",
                                                                    "label": "NULL",
                                                                    "pos": 649,
                                                                    "length": 4,
                                                                    "snippet": "NULL"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 653,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 655,
                                            "length": 101,
                                            "snippet": "{\n        free(globalStruct);\n        globalStruct = NULL;  // Set to NULL might be interrupted\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 655,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 665,
                                                    "length": 19,
                                                    "snippet": "free(globalStruct);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 665,
                                                            "length": 18,
                                                            "snippet": "free(globalStruct)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "free",
                                                                    "pos": 665,
                                                                    "length": 4,
                                                                    "snippet": "free"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 669,
                                                                    "length": 14,
                                                                    "snippet": "(globalStruct)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 669,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 670,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 682,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 683,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 693,
                                                    "length": 20,
                                                    "snippet": "globalStruct = NULL;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 693,
                                                            "length": 19,
                                                            "snippet": "globalStruct = NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 693,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 706,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 708,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 708,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 712,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "// Set to NULL might be interrupted",
                                                    "pos": 715,
                                                    "length": 35,
                                                    "snippet": "// Set to NULL might be interrupted"
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 755,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 757,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// GOOD - Proper handling with mutex for data structures",
                    "pos": 760,
                    "length": 56,
                    "snippet": "// GOOD - Proper handling with mutex for data structures"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 817,
                    "length": 566,
                    "snippet": "void safe_data_structures(void) {\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    pthread_mutex_unlock(&lock);\n    signal(SIGUSR2, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 3;\n        pthread_mutex_unlock(&lock);\n    });\n    \n    pthread_mutex_lock(&lock);\n    globalStruct->val = 5;\n    if (globalStruct != NULL) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 817,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 822,
                            "length": 26,
                            "snippet": "safe_data_structures(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "safe_data_structures",
                                    "pos": 822,
                                    "length": 20,
                                    "snippet": "safe_data_structures"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 842,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 842,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 843,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 843,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 847,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 849,
                            "length": 534,
                            "snippet": "{\n    pthread_mutex_lock(&lock);\n    globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));\n    pthread_mutex_unlock(&lock);\n    signal(SIGUSR2, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 3;\n        pthread_mutex_unlock(&lock);\n    });\n    \n    pthread_mutex_lock(&lock);\n    globalStruct->val = 5;\n    if (globalStruct != NULL) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 849,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 855,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 855,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 855,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 873,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 873,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 874,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 874,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 875,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 879,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 880,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 886,
                                    "length": 66,
                                    "snippet": "globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic));",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 886,
                                            "length": 65,
                                            "snippet": "globalStruct = (structSigAtomic *)malloc(sizeof(structSigAtomic))",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "globalStruct",
                                                    "pos": 886,
                                                    "length": 12,
                                                    "snippet": "globalStruct"
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 899,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 901,
                                                    "length": 50,
                                                    "snippet": "(structSigAtomic *)malloc(sizeof(structSigAtomic))",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 901,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 902,
                                                            "length": 17,
                                                            "snippet": "structSigAtomic *",
                                                            "children": [
                                                                {
                                                                    "type": "type_identifier",
                                                                    "label": "structSigAtomic",
                                                                    "pos": 902,
                                                                    "length": 15,
                                                                    "snippet": "structSigAtomic"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 918,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 918,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 919,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 920,
                                                            "length": 31,
                                                            "snippet": "malloc(sizeof(structSigAtomic))",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 920,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 926,
                                                                    "length": 25,
                                                                    "snippet": "(sizeof(structSigAtomic))",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 926,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "sizeof_expression",
                                                                            "label": "",
                                                                            "pos": 927,
                                                                            "length": 23,
                                                                            "snippet": "sizeof(structSigAtomic)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "sizeof",
                                                                                    "label": "sizeof",
                                                                                    "pos": 927,
                                                                                    "length": 6,
                                                                                    "snippet": "sizeof"
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "",
                                                                                    "pos": 933,
                                                                                    "length": 17,
                                                                                    "snippet": "(structSigAtomic)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "(",
                                                                                            "label": "(",
                                                                                            "pos": 933,
                                                                                            "length": 1,
                                                                                            "snippet": "("
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "structSigAtomic",
                                                                                            "pos": 934,
                                                                                            "length": 15,
                                                                                            "snippet": "structSigAtomic"
                                                                                        },
                                                                                        {
                                                                                            "type": ")",
                                                                                            "label": ")",
                                                                                            "pos": 949,
                                                                                            "length": 1,
                                                                                            "snippet": ")"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 950,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 951,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 957,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 957,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 957,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 977,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 977,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 978,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 978,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 979,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 983,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 984,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 990,
                                    "length": 27,
                                    "snippet": "signal(SIGUSR2, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 990,
                                            "length": 27,
                                            "snippet": "signal(SIGUSR2, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 990,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 996,
                                                    "length": 21,
                                                    "snippet": "(SIGUSR2, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 996,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGUSR2",
                                                            "pos": 997,
                                                            "length": 7,
                                                            "snippet": "SIGUSR2"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 1004,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 1006,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 1006,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 1007,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1008,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 1009,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 1013,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1016,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 1017,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 1018,
                                    "length": 136,
                                    "snippet": "{\n        pthread_mutex_lock(&lock);\n        if (globalStruct != NULL) globalStruct->val = 3;\n        pthread_mutex_unlock(&lock);\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 1018,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1028,
                                            "length": 26,
                                            "snippet": "pthread_mutex_lock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1028,
                                                    "length": 25,
                                                    "snippet": "pthread_mutex_lock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_lock",
                                                            "pos": 1028,
                                                            "length": 18,
                                                            "snippet": "pthread_mutex_lock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1046,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1046,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1047,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1047,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1048,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1052,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1053,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 1063,
                                            "length": 48,
                                            "snippet": "if (globalStruct != NULL) globalStruct->val = 3;",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 1063,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 1066,
                                                    "length": 22,
                                                    "snippet": "(globalStruct != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1066,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 1067,
                                                            "length": 20,
                                                            "snippet": "globalStruct != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1067,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 1080,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1083,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1083,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1087,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1089,
                                                    "length": 22,
                                                    "snippet": "globalStruct->val = 3;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1089,
                                                            "length": 21,
                                                            "snippet": "globalStruct->val = 3",
                                                            "children": [
                                                                {
                                                                    "type": "field_expression",
                                                                    "label": "",
                                                                    "pos": 1089,
                                                                    "length": 17,
                                                                    "snippet": "globalStruct->val",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1089,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": "->",
                                                                            "label": "->",
                                                                            "pos": 1101,
                                                                            "length": 2,
                                                                            "snippet": "->"
                                                                        },
                                                                        {
                                                                            "type": "field_identifier",
                                                                            "label": "val",
                                                                            "pos": 1103,
                                                                            "length": 3,
                                                                            "snippet": "val"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1107,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "3",
                                                                    "pos": 1109,
                                                                    "length": 1,
                                                                    "snippet": "3"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1110,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1120,
                                            "length": 28,
                                            "snippet": "pthread_mutex_unlock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1120,
                                                    "length": 27,
                                                    "snippet": "pthread_mutex_unlock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_unlock",
                                                            "pos": 1120,
                                                            "length": 20,
                                                            "snippet": "pthread_mutex_unlock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1140,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1140,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1141,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1141,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1142,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1146,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1147,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 1153,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 1154,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 1154,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1155,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1155,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1166,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1166,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 1166,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1184,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1184,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1185,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1185,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1186,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1190,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1191,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1197,
                                    "length": 22,
                                    "snippet": "globalStruct->val = 5;",
                                    "children": [
                                        {
                                            "type": "assignment_expression",
                                            "label": "",
                                            "pos": 1197,
                                            "length": 21,
                                            "snippet": "globalStruct->val = 5",
                                            "children": [
                                                {
                                                    "type": "field_expression",
                                                    "label": "",
                                                    "pos": 1197,
                                                    "length": 17,
                                                    "snippet": "globalStruct->val",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 1197,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "->",
                                                            "label": "->",
                                                            "pos": 1209,
                                                            "length": 2,
                                                            "snippet": "->"
                                                        },
                                                        {
                                                            "type": "field_identifier",
                                                            "label": "val",
                                                            "pos": 1211,
                                                            "length": 3,
                                                            "snippet": "val"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 1215,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "number_literal",
                                                    "label": "5",
                                                    "pos": 1217,
                                                    "length": 1,
                                                    "snippet": "5"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1218,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 1224,
                                    "length": 124,
                                    "snippet": "if (globalStruct != NULL) {\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 1224,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 1227,
                                            "length": 22,
                                            "snippet": "(globalStruct != NULL)",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 1227,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 1228,
                                                    "length": 20,
                                                    "snippet": "globalStruct != NULL",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "globalStruct",
                                                            "pos": 1228,
                                                            "length": 12,
                                                            "snippet": "globalStruct"
                                                        },
                                                        {
                                                            "type": "!=",
                                                            "label": "!=",
                                                            "pos": 1241,
                                                            "length": 2,
                                                            "snippet": "!="
                                                        },
                                                        {
                                                            "type": "null",
                                                            "label": "",
                                                            "pos": 1244,
                                                            "length": 4,
                                                            "snippet": "NULL",
                                                            "children": [
                                                                {
                                                                    "type": "NULL",
                                                                    "label": "NULL",
                                                                    "pos": 1244,
                                                                    "length": 4,
                                                                    "snippet": "NULL"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 1248,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 1250,
                                            "length": 98,
                                            "snippet": "{\n        free(globalStruct);  // Freed within a locked section\n        globalStruct = NULL;\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 1250,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1260,
                                                    "length": 19,
                                                    "snippet": "free(globalStruct);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1260,
                                                            "length": 18,
                                                            "snippet": "free(globalStruct)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "free",
                                                                    "pos": 1260,
                                                                    "length": 4,
                                                                    "snippet": "free"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1264,
                                                                    "length": 14,
                                                                    "snippet": "(globalStruct)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1264,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "globalStruct",
                                                                            "pos": 1265,
                                                                            "length": 12,
                                                                            "snippet": "globalStruct"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1277,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1278,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "// Freed within a locked section",
                                                    "pos": 1281,
                                                    "length": 32,
                                                    "snippet": "// Freed within a locked section"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1322,
                                                    "length": 20,
                                                    "snippet": "globalStruct = NULL;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1322,
                                                            "length": 19,
                                                            "snippet": "globalStruct = NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "globalStruct",
                                                                    "pos": 1322,
                                                                    "length": 12,
                                                                    "snippet": "globalStruct"
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1335,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1337,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1337,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1341,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 1347,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1353,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1353,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 1353,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1373,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1373,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1374,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1374,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1375,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1379,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1380,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 1382,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    {
        "file_path": "gpt-generated/CWE364_Signal_Handler_Race_Condition/CWE364_gpt_generated_part5.c",
        "source": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Signal handler race in buffer operations\nvoid vulnerable_buffer_ops(void) {\n    char *buffer = (char *)malloc(100);\n    signal(SIGHUP, [](int sig) {\n        if (buffer != NULL) buffer[0] = '\\0';\n    });\n    // Some operation on buffer\n    snprintf(buffer, 100, \"Some data\");\n    if (buffer[0] != '\\0') {\n        free(buffer);  // Might be interrupted here\n        buffer = NULL;\n    }\n}\n\n// GOOD - Secure buffer operations with signal safety\nvoid safe_buffer_ops(void) {\n    pthread_mutex_lock(&lock);\n    char *buffer = (char *)malloc(100);\n    pthread_mutex_unlock(&lock);\n    signal(SIGHUP, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (buffer != NULL) buffer[0] = '\\0';\n        pthread_mutex_unlock(&lock);\n    });\n    // Some operation on buffer\n    pthread_mutex_lock(&lock);\n    snprintf(buffer, 100, \"Some data\");\n    if (buffer[0] != '\\0') {\n        free(buffer);  // Freed within a locked section\n        buffer = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}\n",
        "ast": {
            "type": "translation_unit",
            "label": "",
            "pos": 0,
            "length": 1332,
            "snippet": "#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n#include <pthread.h>\n\ntypedef struct {\n    int val;\n} structSigAtomic;\n\n// Global variables used across multiple functions\nvolatile sig_atomic_t signalFlag = 0;\nstructSigAtomic *globalStruct = NULL;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// BAD - CWE-364: Signal handler race in buffer operations\nvoid vulnerable_buffer_ops(void) {\n    char *buffer = (char *)malloc(100);\n    signal(SIGHUP, [](int sig) {\n        if (buffer != NULL) buffer[0] = '\\0';\n    });\n    // Some operation on buffer\n    snprintf(buffer, 100, \"Some data\");\n    if (buffer[0] != '\\0') {\n        free(buffer);  // Might be interrupted here\n        buffer = NULL;\n    }\n}\n\n// GOOD - Secure buffer operations with signal safety\nvoid safe_buffer_ops(void) {\n    pthread_mutex_lock(&lock);\n    char *buffer = (char *)malloc(100);\n    pthread_mutex_unlock(&lock);\n    signal(SIGHUP, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (buffer != NULL) buffer[0] = '\\0';\n        pthread_mutex_unlock(&lock);\n    });\n    // Some operation on buffer\n    pthread_mutex_lock(&lock);\n    snprintf(buffer, 100, \"Some data\");\n    if (buffer[0] != '\\0') {\n        free(buffer);  // Freed within a locked section\n        buffer = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
            "children": [
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 0,
                    "length": 19,
                    "snippet": "#include <stdio.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 0,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdio.h>",
                            "pos": 9,
                            "length": 9,
                            "snippet": "<stdio.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 19,
                    "length": 20,
                    "snippet": "#include <stdlib.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 19,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<stdlib.h>",
                            "pos": 28,
                            "length": 10,
                            "snippet": "<stdlib.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 39,
                    "length": 20,
                    "snippet": "#include <signal.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 39,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<signal.h>",
                            "pos": 48,
                            "length": 10,
                            "snippet": "<signal.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 59,
                    "length": 20,
                    "snippet": "#include <unistd.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 59,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<unistd.h>",
                            "pos": 68,
                            "length": 10,
                            "snippet": "<unistd.h>"
                        }
                    ]
                },
                {
                    "type": "preproc_include",
                    "label": "",
                    "pos": 79,
                    "length": 21,
                    "snippet": "#include <pthread.h>\n",
                    "children": [
                        {
                            "type": "#include",
                            "label": "#include",
                            "pos": 79,
                            "length": 8,
                            "snippet": "#include"
                        },
                        {
                            "type": "system_lib_string",
                            "label": "<pthread.h>",
                            "pos": 88,
                            "length": 11,
                            "snippet": "<pthread.h>"
                        }
                    ]
                },
                {
                    "type": "type_definition",
                    "label": "",
                    "pos": 101,
                    "length": 48,
                    "snippet": "typedef struct {\n    int val;\n} structSigAtomic;",
                    "children": [
                        {
                            "type": "typedef",
                            "label": "typedef",
                            "pos": 101,
                            "length": 7,
                            "snippet": "typedef"
                        },
                        {
                            "type": "struct_specifier",
                            "label": "",
                            "pos": 109,
                            "length": 23,
                            "snippet": "struct {\n    int val;\n}",
                            "children": [
                                {
                                    "type": "struct",
                                    "label": "struct",
                                    "pos": 109,
                                    "length": 6,
                                    "snippet": "struct"
                                },
                                {
                                    "type": "field_declaration_list",
                                    "label": "",
                                    "pos": 116,
                                    "length": 16,
                                    "snippet": "{\n    int val;\n}",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 116,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "field_declaration",
                                            "label": "",
                                            "pos": 122,
                                            "length": 8,
                                            "snippet": "int val;",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "int",
                                                    "pos": 122,
                                                    "length": 3,
                                                    "snippet": "int"
                                                },
                                                {
                                                    "type": "field_identifier",
                                                    "label": "val",
                                                    "pos": 126,
                                                    "length": 3,
                                                    "snippet": "val"
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 129,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 131,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 133,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 148,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// Global variables used across multiple functions",
                    "pos": 151,
                    "length": 50,
                    "snippet": "// Global variables used across multiple functions"
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 202,
                    "length": 37,
                    "snippet": "volatile sig_atomic_t signalFlag = 0;",
                    "children": [
                        {
                            "type": "type_qualifier",
                            "label": "",
                            "pos": 202,
                            "length": 8,
                            "snippet": "volatile",
                            "children": [
                                {
                                    "type": "volatile",
                                    "label": "volatile",
                                    "pos": 202,
                                    "length": 8,
                                    "snippet": "volatile"
                                }
                            ]
                        },
                        {
                            "type": "type_identifier",
                            "label": "sig_atomic_t",
                            "pos": 211,
                            "length": 12,
                            "snippet": "sig_atomic_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 224,
                            "length": 14,
                            "snippet": "signalFlag = 0",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "signalFlag",
                                    "pos": 224,
                                    "length": 10,
                                    "snippet": "signalFlag"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 235,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "number_literal",
                                    "label": "0",
                                    "pos": 237,
                                    "length": 1,
                                    "snippet": "0"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 238,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 240,
                    "length": 37,
                    "snippet": "structSigAtomic *globalStruct = NULL;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "structSigAtomic",
                            "pos": 240,
                            "length": 15,
                            "snippet": "structSigAtomic"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 256,
                            "length": 20,
                            "snippet": "*globalStruct = NULL",
                            "children": [
                                {
                                    "type": "pointer_declarator",
                                    "label": "",
                                    "pos": 256,
                                    "length": 13,
                                    "snippet": "*globalStruct",
                                    "children": [
                                        {
                                            "type": "*",
                                            "label": "*",
                                            "pos": 256,
                                            "length": 1,
                                            "snippet": "*"
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "globalStruct",
                                            "pos": 257,
                                            "length": 12,
                                            "snippet": "globalStruct"
                                        }
                                    ]
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 270,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "null",
                                    "label": "",
                                    "pos": 272,
                                    "length": 4,
                                    "snippet": "NULL",
                                    "children": [
                                        {
                                            "type": "NULL",
                                            "label": "NULL",
                                            "pos": 272,
                                            "length": 4,
                                            "snippet": "NULL"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 276,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "declaration",
                    "label": "",
                    "pos": 278,
                    "length": 49,
                    "snippet": "pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;",
                    "children": [
                        {
                            "type": "type_identifier",
                            "label": "pthread_mutex_t",
                            "pos": 278,
                            "length": 15,
                            "snippet": "pthread_mutex_t"
                        },
                        {
                            "type": "init_declarator",
                            "label": "",
                            "pos": 294,
                            "length": 32,
                            "snippet": "lock = PTHREAD_MUTEX_INITIALIZER",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "lock",
                                    "pos": 294,
                                    "length": 4,
                                    "snippet": "lock"
                                },
                                {
                                    "type": "=",
                                    "label": "=",
                                    "pos": 299,
                                    "length": 1,
                                    "snippet": "="
                                },
                                {
                                    "type": "identifier",
                                    "label": "PTHREAD_MUTEX_INITIALIZER",
                                    "pos": 301,
                                    "length": 25,
                                    "snippet": "PTHREAD_MUTEX_INITIALIZER"
                                }
                            ]
                        },
                        {
                            "type": ";",
                            "label": ";",
                            "pos": 326,
                            "length": 1,
                            "snippet": ";"
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// BAD - CWE-364: Signal handler race in buffer operations",
                    "pos": 329,
                    "length": 58,
                    "snippet": "// BAD - CWE-364: Signal handler race in buffer operations"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 388,
                    "length": 345,
                    "snippet": "void vulnerable_buffer_ops(void) {\n    char *buffer = (char *)malloc(100);\n    signal(SIGHUP, [](int sig) {\n        if (buffer != NULL) buffer[0] = '\\0';\n    });\n    // Some operation on buffer\n    snprintf(buffer, 100, \"Some data\");\n    if (buffer[0] != '\\0') {\n        free(buffer);  // Might be interrupted here\n        buffer = NULL;\n    }\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 388,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 393,
                            "length": 27,
                            "snippet": "vulnerable_buffer_ops(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "vulnerable_buffer_ops",
                                    "pos": 393,
                                    "length": 21,
                                    "snippet": "vulnerable_buffer_ops"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 414,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 414,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 415,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 415,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 419,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 421,
                            "length": 312,
                            "snippet": "{\n    char *buffer = (char *)malloc(100);\n    signal(SIGHUP, [](int sig) {\n        if (buffer != NULL) buffer[0] = '\\0';\n    });\n    // Some operation on buffer\n    snprintf(buffer, 100, \"Some data\");\n    if (buffer[0] != '\\0') {\n        free(buffer);  // Might be interrupted here\n        buffer = NULL;\n    }\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 421,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "declaration",
                                    "label": "",
                                    "pos": 427,
                                    "length": 35,
                                    "snippet": "char *buffer = (char *)malloc(100);",
                                    "children": [
                                        {
                                            "type": "primitive_type",
                                            "label": "char",
                                            "pos": 427,
                                            "length": 4,
                                            "snippet": "char"
                                        },
                                        {
                                            "type": "init_declarator",
                                            "label": "",
                                            "pos": 432,
                                            "length": 29,
                                            "snippet": "*buffer = (char *)malloc(100)",
                                            "children": [
                                                {
                                                    "type": "pointer_declarator",
                                                    "label": "",
                                                    "pos": 432,
                                                    "length": 7,
                                                    "snippet": "*buffer",
                                                    "children": [
                                                        {
                                                            "type": "*",
                                                            "label": "*",
                                                            "pos": 432,
                                                            "length": 1,
                                                            "snippet": "*"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "buffer",
                                                            "pos": 433,
                                                            "length": 6,
                                                            "snippet": "buffer"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 440,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 442,
                                                    "length": 19,
                                                    "snippet": "(char *)malloc(100)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 442,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 443,
                                                            "length": 6,
                                                            "snippet": "char *",
                                                            "children": [
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "char",
                                                                    "pos": 443,
                                                                    "length": 4,
                                                                    "snippet": "char"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 448,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 448,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 449,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 450,
                                                            "length": 11,
                                                            "snippet": "malloc(100)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 450,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 456,
                                                                    "length": 5,
                                                                    "snippet": "(100)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 456,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "number_literal",
                                                                            "label": "100",
                                                                            "pos": 457,
                                                                            "length": 3,
                                                                            "snippet": "100"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 460,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 461,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 467,
                                    "length": 26,
                                    "snippet": "signal(SIGHUP, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 467,
                                            "length": 26,
                                            "snippet": "signal(SIGHUP, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 467,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 473,
                                                    "length": 20,
                                                    "snippet": "(SIGHUP, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 473,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGHUP",
                                                            "pos": 474,
                                                            "length": 6,
                                                            "snippet": "SIGHUP"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 480,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 482,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 482,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 483,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 484,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 485,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 489,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 492,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 493,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 494,
                                    "length": 53,
                                    "snippet": "{\n        if (buffer != NULL) buffer[0] = '\\0';\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 494,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 504,
                                            "length": 37,
                                            "snippet": "if (buffer != NULL) buffer[0] = '\\0';",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 504,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 507,
                                                    "length": 16,
                                                    "snippet": "(buffer != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 507,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 508,
                                                            "length": 14,
                                                            "snippet": "buffer != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "buffer",
                                                                    "pos": 508,
                                                                    "length": 6,
                                                                    "snippet": "buffer"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 515,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 518,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 518,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 522,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 524,
                                                    "length": 17,
                                                    "snippet": "buffer[0] = '\\0';",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 524,
                                                            "length": 16,
                                                            "snippet": "buffer[0] = '\\0'",
                                                            "children": [
                                                                {
                                                                    "type": "subscript_expression",
                                                                    "label": "",
                                                                    "pos": 524,
                                                                    "length": 9,
                                                                    "snippet": "buffer[0]",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "buffer",
                                                                            "pos": 524,
                                                                            "length": 6,
                                                                            "snippet": "buffer"
                                                                        },
                                                                        {
                                                                            "type": "[",
                                                                            "label": "[",
                                                                            "pos": 530,
                                                                            "length": 1,
                                                                            "snippet": "["
                                                                        },
                                                                        {
                                                                            "type": "number_literal",
                                                                            "label": "0",
                                                                            "pos": 531,
                                                                            "length": 1,
                                                                            "snippet": "0"
                                                                        },
                                                                        {
                                                                            "type": "]",
                                                                            "label": "]",
                                                                            "pos": 532,
                                                                            "length": 1,
                                                                            "snippet": "]"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 534,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "char_literal",
                                                                    "label": "",
                                                                    "pos": 536,
                                                                    "length": 4,
                                                                    "snippet": "'\\0'",
                                                                    "children": [
                                                                        {
                                                                            "type": "'",
                                                                            "label": "'",
                                                                            "pos": 536,
                                                                            "length": 1,
                                                                            "snippet": "'"
                                                                        },
                                                                        {
                                                                            "type": "escape_sequence",
                                                                            "label": "\\0",
                                                                            "pos": 537,
                                                                            "length": 2,
                                                                            "snippet": "\\0"
                                                                        },
                                                                        {
                                                                            "type": "'",
                                                                            "label": "'",
                                                                            "pos": 539,
                                                                            "length": 1,
                                                                            "snippet": "'"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 540,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 546,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 547,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 547,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 548,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 548,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "comment",
                                    "label": "// Some operation on buffer",
                                    "pos": 554,
                                    "length": 27,
                                    "snippet": "// Some operation on buffer"
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 586,
                                    "length": 35,
                                    "snippet": "snprintf(buffer, 100, \"Some data\");",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 586,
                                            "length": 34,
                                            "snippet": "snprintf(buffer, 100, \"Some data\")",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "snprintf",
                                                    "pos": 586,
                                                    "length": 8,
                                                    "snippet": "snprintf"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 594,
                                                    "length": 26,
                                                    "snippet": "(buffer, 100, \"Some data\")",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 594,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "buffer",
                                                            "pos": 595,
                                                            "length": 6,
                                                            "snippet": "buffer"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 601,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "number_literal",
                                                            "label": "100",
                                                            "pos": 603,
                                                            "length": 3,
                                                            "snippet": "100"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 606,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "string_literal",
                                                            "label": "",
                                                            "pos": 608,
                                                            "length": 11,
                                                            "snippet": "\"Some data\"",
                                                            "children": [
                                                                {
                                                                    "type": "\"",
                                                                    "label": "\"",
                                                                    "pos": 608,
                                                                    "length": 1,
                                                                    "snippet": "\""
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "Some data",
                                                                    "pos": 609,
                                                                    "length": 9,
                                                                    "snippet": "Some data"
                                                                },
                                                                {
                                                                    "type": "\"",
                                                                    "label": "\"",
                                                                    "pos": 618,
                                                                    "length": 1,
                                                                    "snippet": "\""
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 619,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 620,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 626,
                                    "length": 105,
                                    "snippet": "if (buffer[0] != '\\0') {\n        free(buffer);  // Might be interrupted here\n        buffer = NULL;\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 626,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 629,
                                            "length": 19,
                                            "snippet": "(buffer[0] != '\\0')",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 629,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 630,
                                                    "length": 17,
                                                    "snippet": "buffer[0] != '\\0'",
                                                    "children": [
                                                        {
                                                            "type": "subscript_expression",
                                                            "label": "",
                                                            "pos": 630,
                                                            "length": 9,
                                                            "snippet": "buffer[0]",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "buffer",
                                                                    "pos": 630,
                                                                    "length": 6,
                                                                    "snippet": "buffer"
                                                                },
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 636,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "0",
                                                                    "pos": 637,
                                                                    "length": 1,
                                                                    "snippet": "0"
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 638,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "!=",
                                                            "label": "!=",
                                                            "pos": 640,
                                                            "length": 2,
                                                            "snippet": "!="
                                                        },
                                                        {
                                                            "type": "char_literal",
                                                            "label": "",
                                                            "pos": 643,
                                                            "length": 4,
                                                            "snippet": "'\\0'",
                                                            "children": [
                                                                {
                                                                    "type": "'",
                                                                    "label": "'",
                                                                    "pos": 643,
                                                                    "length": 1,
                                                                    "snippet": "'"
                                                                },
                                                                {
                                                                    "type": "escape_sequence",
                                                                    "label": "\\0",
                                                                    "pos": 644,
                                                                    "length": 2,
                                                                    "snippet": "\\0"
                                                                },
                                                                {
                                                                    "type": "'",
                                                                    "label": "'",
                                                                    "pos": 646,
                                                                    "length": 1,
                                                                    "snippet": "'"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 647,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 649,
                                            "length": 82,
                                            "snippet": "{\n        free(buffer);  // Might be interrupted here\n        buffer = NULL;\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 649,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 659,
                                                    "length": 13,
                                                    "snippet": "free(buffer);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 659,
                                                            "length": 12,
                                                            "snippet": "free(buffer)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "free",
                                                                    "pos": 659,
                                                                    "length": 4,
                                                                    "snippet": "free"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 663,
                                                                    "length": 8,
                                                                    "snippet": "(buffer)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 663,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "buffer",
                                                                            "pos": 664,
                                                                            "length": 6,
                                                                            "snippet": "buffer"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 670,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 671,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "// Might be interrupted here",
                                                    "pos": 674,
                                                    "length": 28,
                                                    "snippet": "// Might be interrupted here"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 711,
                                                    "length": 14,
                                                    "snippet": "buffer = NULL;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 711,
                                                            "length": 13,
                                                            "snippet": "buffer = NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "buffer",
                                                                    "pos": 711,
                                                                    "length": 6,
                                                                    "snippet": "buffer"
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 718,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 720,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 720,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 724,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 730,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 732,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "// GOOD - Secure buffer operations with signal safety",
                    "pos": 735,
                    "length": 53,
                    "snippet": "// GOOD - Secure buffer operations with signal safety"
                },
                {
                    "type": "function_definition",
                    "label": "",
                    "pos": 789,
                    "length": 543,
                    "snippet": "void safe_buffer_ops(void) {\n    pthread_mutex_lock(&lock);\n    char *buffer = (char *)malloc(100);\n    pthread_mutex_unlock(&lock);\n    signal(SIGHUP, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (buffer != NULL) buffer[0] = '\\0';\n        pthread_mutex_unlock(&lock);\n    });\n    // Some operation on buffer\n    pthread_mutex_lock(&lock);\n    snprintf(buffer, 100, \"Some data\");\n    if (buffer[0] != '\\0') {\n        free(buffer);  // Freed within a locked section\n        buffer = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
                    "children": [
                        {
                            "type": "primitive_type",
                            "label": "void",
                            "pos": 789,
                            "length": 4,
                            "snippet": "void"
                        },
                        {
                            "type": "function_declarator",
                            "label": "",
                            "pos": 794,
                            "length": 21,
                            "snippet": "safe_buffer_ops(void)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "safe_buffer_ops",
                                    "pos": 794,
                                    "length": 15,
                                    "snippet": "safe_buffer_ops"
                                },
                                {
                                    "type": "parameter_list",
                                    "label": "",
                                    "pos": 809,
                                    "length": 6,
                                    "snippet": "(void)",
                                    "children": [
                                        {
                                            "type": "(",
                                            "label": "(",
                                            "pos": 809,
                                            "length": 1,
                                            "snippet": "("
                                        },
                                        {
                                            "type": "parameter_declaration",
                                            "label": "",
                                            "pos": 810,
                                            "length": 4,
                                            "snippet": "void",
                                            "children": [
                                                {
                                                    "type": "primitive_type",
                                                    "label": "void",
                                                    "pos": 810,
                                                    "length": 4,
                                                    "snippet": "void"
                                                }
                                            ]
                                        },
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 814,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "compound_statement",
                            "label": "",
                            "pos": 816,
                            "length": 516,
                            "snippet": "{\n    pthread_mutex_lock(&lock);\n    char *buffer = (char *)malloc(100);\n    pthread_mutex_unlock(&lock);\n    signal(SIGHUP, [](int sig) {\n        pthread_mutex_lock(&lock);\n        if (buffer != NULL) buffer[0] = '\\0';\n        pthread_mutex_unlock(&lock);\n    });\n    // Some operation on buffer\n    pthread_mutex_lock(&lock);\n    snprintf(buffer, 100, \"Some data\");\n    if (buffer[0] != '\\0') {\n        free(buffer);  // Freed within a locked section\n        buffer = NULL;\n    }\n    pthread_mutex_unlock(&lock);\n}",
                            "children": [
                                {
                                    "type": "{",
                                    "label": "{",
                                    "pos": 816,
                                    "length": 1,
                                    "snippet": "{"
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 822,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 822,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 822,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 840,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 840,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 841,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 841,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 842,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 846,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 847,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "declaration",
                                    "label": "",
                                    "pos": 853,
                                    "length": 35,
                                    "snippet": "char *buffer = (char *)malloc(100);",
                                    "children": [
                                        {
                                            "type": "primitive_type",
                                            "label": "char",
                                            "pos": 853,
                                            "length": 4,
                                            "snippet": "char"
                                        },
                                        {
                                            "type": "init_declarator",
                                            "label": "",
                                            "pos": 858,
                                            "length": 29,
                                            "snippet": "*buffer = (char *)malloc(100)",
                                            "children": [
                                                {
                                                    "type": "pointer_declarator",
                                                    "label": "",
                                                    "pos": 858,
                                                    "length": 7,
                                                    "snippet": "*buffer",
                                                    "children": [
                                                        {
                                                            "type": "*",
                                                            "label": "*",
                                                            "pos": 858,
                                                            "length": 1,
                                                            "snippet": "*"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "buffer",
                                                            "pos": 859,
                                                            "length": 6,
                                                            "snippet": "buffer"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "=",
                                                    "label": "=",
                                                    "pos": 866,
                                                    "length": 1,
                                                    "snippet": "="
                                                },
                                                {
                                                    "type": "cast_expression",
                                                    "label": "",
                                                    "pos": 868,
                                                    "length": 19,
                                                    "snippet": "(char *)malloc(100)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 868,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "type_descriptor",
                                                            "label": "",
                                                            "pos": 869,
                                                            "length": 6,
                                                            "snippet": "char *",
                                                            "children": [
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "char",
                                                                    "pos": 869,
                                                                    "length": 4,
                                                                    "snippet": "char"
                                                                },
                                                                {
                                                                    "type": "abstract_pointer_declarator",
                                                                    "label": "",
                                                                    "pos": 874,
                                                                    "length": 1,
                                                                    "snippet": "*",
                                                                    "children": [
                                                                        {
                                                                            "type": "*",
                                                                            "label": "*",
                                                                            "pos": 874,
                                                                            "length": 1,
                                                                            "snippet": "*"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 875,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        },
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 876,
                                                            "length": 11,
                                                            "snippet": "malloc(100)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "malloc",
                                                                    "pos": 876,
                                                                    "length": 6,
                                                                    "snippet": "malloc"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 882,
                                                                    "length": 5,
                                                                    "snippet": "(100)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 882,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "number_literal",
                                                                            "label": "100",
                                                                            "pos": 883,
                                                                            "length": 3,
                                                                            "snippet": "100"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 886,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 887,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 893,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 893,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 893,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 913,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 913,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 914,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 914,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 915,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 919,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 920,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 926,
                                    "length": 26,
                                    "snippet": "signal(SIGHUP, [](int sig)",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 926,
                                            "length": 26,
                                            "snippet": "signal(SIGHUP, [](int sig)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "signal",
                                                    "pos": 926,
                                                    "length": 6,
                                                    "snippet": "signal"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 932,
                                                    "length": 20,
                                                    "snippet": "(SIGHUP, [](int sig)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 932,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "SIGHUP",
                                                            "pos": 933,
                                                            "length": 6,
                                                            "snippet": "SIGHUP"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 939,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "ERROR",
                                                            "label": "",
                                                            "pos": 941,
                                                            "length": 6,
                                                            "snippet": "[](int",
                                                            "children": [
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 941,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 942,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                },
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 943,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "primitive_type",
                                                                    "label": "int",
                                                                    "pos": 944,
                                                                    "length": 3,
                                                                    "snippet": "int"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sig",
                                                            "pos": 948,
                                                            "length": 3,
                                                            "snippet": "sig"
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 951,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": "",
                                            "pos": 952,
                                            "length": 0
                                        }
                                    ]
                                },
                                {
                                    "type": "compound_statement",
                                    "label": "",
                                    "pos": 953,
                                    "length": 125,
                                    "snippet": "{\n        pthread_mutex_lock(&lock);\n        if (buffer != NULL) buffer[0] = '\\0';\n        pthread_mutex_unlock(&lock);\n    }",
                                    "children": [
                                        {
                                            "type": "{",
                                            "label": "{",
                                            "pos": 953,
                                            "length": 1,
                                            "snippet": "{"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 963,
                                            "length": 26,
                                            "snippet": "pthread_mutex_lock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 963,
                                                    "length": 25,
                                                    "snippet": "pthread_mutex_lock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_lock",
                                                            "pos": 963,
                                                            "length": 18,
                                                            "snippet": "pthread_mutex_lock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 981,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 981,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 982,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 982,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 983,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 987,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 988,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "",
                                            "pos": 998,
                                            "length": 37,
                                            "snippet": "if (buffer != NULL) buffer[0] = '\\0';",
                                            "children": [
                                                {
                                                    "type": "if",
                                                    "label": "if",
                                                    "pos": 998,
                                                    "length": 2,
                                                    "snippet": "if"
                                                },
                                                {
                                                    "type": "parenthesized_expression",
                                                    "label": "",
                                                    "pos": 1001,
                                                    "length": 16,
                                                    "snippet": "(buffer != NULL)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1001,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "binary_expression",
                                                            "label": "",
                                                            "pos": 1002,
                                                            "length": 14,
                                                            "snippet": "buffer != NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "buffer",
                                                                    "pos": 1002,
                                                                    "length": 6,
                                                                    "snippet": "buffer"
                                                                },
                                                                {
                                                                    "type": "!=",
                                                                    "label": "!=",
                                                                    "pos": 1009,
                                                                    "length": 2,
                                                                    "snippet": "!="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1012,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1012,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1016,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1018,
                                                    "length": 17,
                                                    "snippet": "buffer[0] = '\\0';",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1018,
                                                            "length": 16,
                                                            "snippet": "buffer[0] = '\\0'",
                                                            "children": [
                                                                {
                                                                    "type": "subscript_expression",
                                                                    "label": "",
                                                                    "pos": 1018,
                                                                    "length": 9,
                                                                    "snippet": "buffer[0]",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "buffer",
                                                                            "pos": 1018,
                                                                            "length": 6,
                                                                            "snippet": "buffer"
                                                                        },
                                                                        {
                                                                            "type": "[",
                                                                            "label": "[",
                                                                            "pos": 1024,
                                                                            "length": 1,
                                                                            "snippet": "["
                                                                        },
                                                                        {
                                                                            "type": "number_literal",
                                                                            "label": "0",
                                                                            "pos": 1025,
                                                                            "length": 1,
                                                                            "snippet": "0"
                                                                        },
                                                                        {
                                                                            "type": "]",
                                                                            "label": "]",
                                                                            "pos": 1026,
                                                                            "length": 1,
                                                                            "snippet": "]"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1028,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "char_literal",
                                                                    "label": "",
                                                                    "pos": 1030,
                                                                    "length": 4,
                                                                    "snippet": "'\\0'",
                                                                    "children": [
                                                                        {
                                                                            "type": "'",
                                                                            "label": "'",
                                                                            "pos": 1030,
                                                                            "length": 1,
                                                                            "snippet": "'"
                                                                        },
                                                                        {
                                                                            "type": "escape_sequence",
                                                                            "label": "\\0",
                                                                            "pos": 1031,
                                                                            "length": 2,
                                                                            "snippet": "\\0"
                                                                        },
                                                                        {
                                                                            "type": "'",
                                                                            "label": "'",
                                                                            "pos": 1033,
                                                                            "length": 1,
                                                                            "snippet": "'"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1034,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "",
                                            "pos": 1044,
                                            "length": 28,
                                            "snippet": "pthread_mutex_unlock(&lock);",
                                            "children": [
                                                {
                                                    "type": "call_expression",
                                                    "label": "",
                                                    "pos": 1044,
                                                    "length": 27,
                                                    "snippet": "pthread_mutex_unlock(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "pthread_mutex_unlock",
                                                            "pos": 1044,
                                                            "length": 20,
                                                            "snippet": "pthread_mutex_unlock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "",
                                                            "pos": 1064,
                                                            "length": 7,
                                                            "snippet": "(&lock)",
                                                            "children": [
                                                                {
                                                                    "type": "(",
                                                                    "label": "(",
                                                                    "pos": 1064,
                                                                    "length": 1,
                                                                    "snippet": "("
                                                                },
                                                                {
                                                                    "type": "pointer_expression",
                                                                    "label": "",
                                                                    "pos": 1065,
                                                                    "length": 5,
                                                                    "snippet": "&lock",
                                                                    "children": [
                                                                        {
                                                                            "type": "&",
                                                                            "label": "&",
                                                                            "pos": 1065,
                                                                            "length": 1,
                                                                            "snippet": "&"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "pos": 1066,
                                                                            "length": 4,
                                                                            "snippet": "lock"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": ")",
                                                                    "label": ")",
                                                                    "pos": 1070,
                                                                    "length": 1,
                                                                    "snippet": ")"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ";",
                                                    "label": ";",
                                                    "pos": 1071,
                                                    "length": 1,
                                                    "snippet": ";"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "}",
                                            "label": "}",
                                            "pos": 1077,
                                            "length": 1,
                                            "snippet": "}"
                                        }
                                    ]
                                },
                                {
                                    "type": "ERROR",
                                    "label": "",
                                    "pos": 1078,
                                    "length": 1,
                                    "snippet": ")",
                                    "children": [
                                        {
                                            "type": ")",
                                            "label": ")",
                                            "pos": 1078,
                                            "length": 1,
                                            "snippet": ")"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1079,
                                    "length": 1,
                                    "snippet": ";",
                                    "children": [
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1079,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "comment",
                                    "label": "// Some operation on buffer",
                                    "pos": 1085,
                                    "length": 27,
                                    "snippet": "// Some operation on buffer"
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1117,
                                    "length": 26,
                                    "snippet": "pthread_mutex_lock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1117,
                                            "length": 25,
                                            "snippet": "pthread_mutex_lock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_lock",
                                                    "pos": 1117,
                                                    "length": 18,
                                                    "snippet": "pthread_mutex_lock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1135,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1135,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1136,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1136,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1137,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1141,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1142,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1148,
                                    "length": 35,
                                    "snippet": "snprintf(buffer, 100, \"Some data\");",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1148,
                                            "length": 34,
                                            "snippet": "snprintf(buffer, 100, \"Some data\")",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "snprintf",
                                                    "pos": 1148,
                                                    "length": 8,
                                                    "snippet": "snprintf"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1156,
                                                    "length": 26,
                                                    "snippet": "(buffer, 100, \"Some data\")",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1156,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "buffer",
                                                            "pos": 1157,
                                                            "length": 6,
                                                            "snippet": "buffer"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 1163,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "number_literal",
                                                            "label": "100",
                                                            "pos": 1165,
                                                            "length": 3,
                                                            "snippet": "100"
                                                        },
                                                        {
                                                            "type": ",",
                                                            "label": ",",
                                                            "pos": 1168,
                                                            "length": 1,
                                                            "snippet": ","
                                                        },
                                                        {
                                                            "type": "string_literal",
                                                            "label": "",
                                                            "pos": 1170,
                                                            "length": 11,
                                                            "snippet": "\"Some data\"",
                                                            "children": [
                                                                {
                                                                    "type": "\"",
                                                                    "label": "\"",
                                                                    "pos": 1170,
                                                                    "length": 1,
                                                                    "snippet": "\""
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "Some data",
                                                                    "pos": 1171,
                                                                    "length": 9,
                                                                    "snippet": "Some data"
                                                                },
                                                                {
                                                                    "type": "\"",
                                                                    "label": "\"",
                                                                    "pos": 1180,
                                                                    "length": 1,
                                                                    "snippet": "\""
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1181,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1182,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "if_statement",
                                    "label": "",
                                    "pos": 1188,
                                    "length": 109,
                                    "snippet": "if (buffer[0] != '\\0') {\n        free(buffer);  // Freed within a locked section\n        buffer = NULL;\n    }",
                                    "children": [
                                        {
                                            "type": "if",
                                            "label": "if",
                                            "pos": 1188,
                                            "length": 2,
                                            "snippet": "if"
                                        },
                                        {
                                            "type": "parenthesized_expression",
                                            "label": "",
                                            "pos": 1191,
                                            "length": 19,
                                            "snippet": "(buffer[0] != '\\0')",
                                            "children": [
                                                {
                                                    "type": "(",
                                                    "label": "(",
                                                    "pos": 1191,
                                                    "length": 1,
                                                    "snippet": "("
                                                },
                                                {
                                                    "type": "binary_expression",
                                                    "label": "",
                                                    "pos": 1192,
                                                    "length": 17,
                                                    "snippet": "buffer[0] != '\\0'",
                                                    "children": [
                                                        {
                                                            "type": "subscript_expression",
                                                            "label": "",
                                                            "pos": 1192,
                                                            "length": 9,
                                                            "snippet": "buffer[0]",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "buffer",
                                                                    "pos": 1192,
                                                                    "length": 6,
                                                                    "snippet": "buffer"
                                                                },
                                                                {
                                                                    "type": "[",
                                                                    "label": "[",
                                                                    "pos": 1198,
                                                                    "length": 1,
                                                                    "snippet": "["
                                                                },
                                                                {
                                                                    "type": "number_literal",
                                                                    "label": "0",
                                                                    "pos": 1199,
                                                                    "length": 1,
                                                                    "snippet": "0"
                                                                },
                                                                {
                                                                    "type": "]",
                                                                    "label": "]",
                                                                    "pos": 1200,
                                                                    "length": 1,
                                                                    "snippet": "]"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "!=",
                                                            "label": "!=",
                                                            "pos": 1202,
                                                            "length": 2,
                                                            "snippet": "!="
                                                        },
                                                        {
                                                            "type": "char_literal",
                                                            "label": "",
                                                            "pos": 1205,
                                                            "length": 4,
                                                            "snippet": "'\\0'",
                                                            "children": [
                                                                {
                                                                    "type": "'",
                                                                    "label": "'",
                                                                    "pos": 1205,
                                                                    "length": 1,
                                                                    "snippet": "'"
                                                                },
                                                                {
                                                                    "type": "escape_sequence",
                                                                    "label": "\\0",
                                                                    "pos": 1206,
                                                                    "length": 2,
                                                                    "snippet": "\\0"
                                                                },
                                                                {
                                                                    "type": "'",
                                                                    "label": "'",
                                                                    "pos": 1208,
                                                                    "length": 1,
                                                                    "snippet": "'"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": ")",
                                                    "label": ")",
                                                    "pos": 1209,
                                                    "length": 1,
                                                    "snippet": ")"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "compound_statement",
                                            "label": "",
                                            "pos": 1211,
                                            "length": 86,
                                            "snippet": "{\n        free(buffer);  // Freed within a locked section\n        buffer = NULL;\n    }",
                                            "children": [
                                                {
                                                    "type": "{",
                                                    "label": "{",
                                                    "pos": 1211,
                                                    "length": 1,
                                                    "snippet": "{"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1221,
                                                    "length": 13,
                                                    "snippet": "free(buffer);",
                                                    "children": [
                                                        {
                                                            "type": "call_expression",
                                                            "label": "",
                                                            "pos": 1221,
                                                            "length": 12,
                                                            "snippet": "free(buffer)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "free",
                                                                    "pos": 1221,
                                                                    "length": 4,
                                                                    "snippet": "free"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "",
                                                                    "pos": 1225,
                                                                    "length": 8,
                                                                    "snippet": "(buffer)",
                                                                    "children": [
                                                                        {
                                                                            "type": "(",
                                                                            "label": "(",
                                                                            "pos": 1225,
                                                                            "length": 1,
                                                                            "snippet": "("
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "buffer",
                                                                            "pos": 1226,
                                                                            "length": 6,
                                                                            "snippet": "buffer"
                                                                        },
                                                                        {
                                                                            "type": ")",
                                                                            "label": ")",
                                                                            "pos": 1232,
                                                                            "length": 1,
                                                                            "snippet": ")"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1233,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "// Freed within a locked section",
                                                    "pos": 1236,
                                                    "length": 32,
                                                    "snippet": "// Freed within a locked section"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "",
                                                    "pos": 1277,
                                                    "length": 14,
                                                    "snippet": "buffer = NULL;",
                                                    "children": [
                                                        {
                                                            "type": "assignment_expression",
                                                            "label": "",
                                                            "pos": 1277,
                                                            "length": 13,
                                                            "snippet": "buffer = NULL",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "buffer",
                                                                    "pos": 1277,
                                                                    "length": 6,
                                                                    "snippet": "buffer"
                                                                },
                                                                {
                                                                    "type": "=",
                                                                    "label": "=",
                                                                    "pos": 1284,
                                                                    "length": 1,
                                                                    "snippet": "="
                                                                },
                                                                {
                                                                    "type": "null",
                                                                    "label": "",
                                                                    "pos": 1286,
                                                                    "length": 4,
                                                                    "snippet": "NULL",
                                                                    "children": [
                                                                        {
                                                                            "type": "NULL",
                                                                            "label": "NULL",
                                                                            "pos": 1286,
                                                                            "length": 4,
                                                                            "snippet": "NULL"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ";",
                                                            "label": ";",
                                                            "pos": 1290,
                                                            "length": 1,
                                                            "snippet": ";"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "}",
                                                    "label": "}",
                                                    "pos": 1296,
                                                    "length": 1,
                                                    "snippet": "}"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "expression_statement",
                                    "label": "",
                                    "pos": 1302,
                                    "length": 28,
                                    "snippet": "pthread_mutex_unlock(&lock);",
                                    "children": [
                                        {
                                            "type": "call_expression",
                                            "label": "",
                                            "pos": 1302,
                                            "length": 27,
                                            "snippet": "pthread_mutex_unlock(&lock)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "pthread_mutex_unlock",
                                                    "pos": 1302,
                                                    "length": 20,
                                                    "snippet": "pthread_mutex_unlock"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "",
                                                    "pos": 1322,
                                                    "length": 7,
                                                    "snippet": "(&lock)",
                                                    "children": [
                                                        {
                                                            "type": "(",
                                                            "label": "(",
                                                            "pos": 1322,
                                                            "length": 1,
                                                            "snippet": "("
                                                        },
                                                        {
                                                            "type": "pointer_expression",
                                                            "label": "",
                                                            "pos": 1323,
                                                            "length": 5,
                                                            "snippet": "&lock",
                                                            "children": [
                                                                {
                                                                    "type": "&",
                                                                    "label": "&",
                                                                    "pos": 1323,
                                                                    "length": 1,
                                                                    "snippet": "&"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "pos": 1324,
                                                                    "length": 4,
                                                                    "snippet": "lock"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": ")",
                                                            "label": ")",
                                                            "pos": 1328,
                                                            "length": 1,
                                                            "snippet": ")"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": ";",
                                            "label": ";",
                                            "pos": 1329,
                                            "length": 1,
                                            "snippet": ";"
                                        }
                                    ]
                                },
                                {
                                    "type": "}",
                                    "label": "}",
                                    "pos": 1331,
                                    "length": 1,
                                    "snippet": "}"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    }
]